{{ header }} 
{% if ((settings['step']['login']['option']['guest']['display']) and (facebook_enable or google_enable) ) %} 
 {% set login_boxes_width=31.1 %}
{% else %} 
 {% set login_boxes_width=47.7 %}
{% endif %}

<style>
.supercheckout_top_boxes{width:{{ login_boxes_width }}%;}
.supercheckout_login_option_box{
    background-color:rgba(7, 8, 5, 0.02) !important
}
</style>
<script src="catalog/view/javascript/jquery/datetimepicker/moment/moment.min.js" type="text/javascript"></script>
<script src="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<link href="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.css" type="text/css" rel="stylesheet" media="screen" />
<!--<link href="catalog/view/stylesheet/bootstrap.css" type="text/css" rel="stylesheet" />-->

<link rel="stylesheet" type="text/css" href="catalog/view/theme/{{ default_theme }}/stylesheet/supercheckout-light.css" />
<link rel="stylesheet" type="text/css" href="catalog/view/theme/{{ default_theme }}/stylesheet/supercheckout/theme/scripts/plugins/notifications/notyfy/jquery.notyfy.css" />
<link rel="stylesheet" type="text/css" href="catalog/view/theme/{{ default_theme }}/stylesheet/supercheckout/theme/scripts/plugins/notifications/notyfy/themes/default.css" />
<link rel="stylesheet" type="text/css" href="catalog/view/theme/{{ default_theme }}/stylesheet/supercheckout/theme/scripts/plugins/notifications/Gritter/css/jquery.gritter.css" />
<link rel="stylesheet" type="text/css" href="catalog/view/theme/{{ default_theme }}/stylesheet/supercheckout/colorbox.css" />
<link rel="stylesheet" type="text/css" href="catalog/view/javascript/bootstrap_select/css/select2.min.css" />

<style>
 {% if (settings['custom']['style'] is defined) %}{{ settings['custom']['style'] }}{% endif %}  
 #progressbar .ui-progressbar-value{
    height: 2px;
}
</style>

<div id="fb-root"></div>
<div class="container">
    <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %} 
        <li><a href="{{ breadcrumb['href'] }}">{{ breadcrumb['text'] }}</a></li>
        {% endfor %} 
    </ul>
<div id="content">
    {% if (settings['step']['html_value']['value']['header'] is defined and settings['step']['html_value']['value']['header'] != "") %} 
                <div id="supercheckout_html_content_header">        
                    {{ ( settings['step']['html_value']['value']['header']) }} 
                </div>
    {% endif %} 
    <fieldset class="group-select" id="supercheckout-fieldset">
        <div id="form_disable" style="background:#e0ffbb; opacity:0.1; z-index:99999; position: absolute; display:none;"></div>
        <div class="supercheckout-threecolumns supercheckout-container supercheckout-skin-generic " id="supercheckout-columnleft">
            
 {% if (settings['general']['layout'] == '3-Column') %}
    {% set layout_name='three-column' %}
    {% set multiplier=0.895 %}
 {% elseif (settings['general']['layout'] == '2-Column') %}
    {% set layout_name='two-column' %}
    {% set multiplier=0.947 %}
 {% elseif (settings['general']['layout'] == '1-Column') %}
    {% set layout_name='one-column' %}
    {% set multiplier=1 %}
 {% endif %}

 
            <div class="supercheckout-column-left columnleftsort" id="columnleft-1" style="width:{% set i= settings['general']['column_width'][layout_name][1]*multiplier %}{{ i }}%"> 
                <div  class="supercheckout-blocks" data-column="{{ sort_block['login'][layout_name]['column'] }}" data-row="{{ sort_block['login'][layout_name]['row'] }}" data-column-inside="{{ sort_block['login'][layout_name]['column-inside'] }}"  >
                    <ul class="headingCheckout">
                        <li>
                            <p class="supercheckout-numbers supercheckout-numbers-1">{% if (not logged) %}{{ text_login_option }}{% else %}{{ text_welcome~ ' '~firstName~ ' '~lastName }}{% endif %}</p>
                        </li>
                    </ul>
                    <div id="checkoutLogin">
                        <div class="supercheckout-checkout-content">
                        </div>
                        {% if (not logged) %} 
                        <div class="supercheckout-extra-wrap">
                            <b>{{ entry_email }}<span class="supercheckout-required">*</span></b><br />
                            <input type="text" id="email" name="email" value="" class="supercheckout-large-field" />
                            <br/>
                        </div>    
                        <div id="loginDetails" style="display:{% if (settings['step']['login']['option']['guest']['display'] == 0) %}{{ 'none' }}{% else %}{{ 'block' }}{% endif %};">
                            <div class="supercheckout-extra-wrap">
                                <label for="guest">
                                    <input type="radio" name="account" value="guest" id="guest" {% if (account == 'guest') %}{{ ' checked="checked"' }}{% endif %} />
                                    <b> {{ text_guest }}</b>
                                </label>
                                <br />
                            </div>
                        </div>
                        <div>
                            <div class="supercheckout-extra-wrap">
                                <label for="register">
                                    <input type="radio" name="account" value="register" id="register" {% if (account == 'register' or (account == 'register_manual' and settings['general']['guest_manual'] == 0) or (account == 'guest' and settings['step']['login']['option']['guest']['display'] == 0)) %}{{ ' checked="checked"' }}{% endif %} />
                                    <b>{{ text_register }}</b>
                                </label>
                                <br />
                            </div>
                            {% if (settings['general']['guest_manual']) %} 
                            <div class="supercheckout-extra-wrap">
                                <label for="register_manual">
                                    {% if (account == 'register_manual') %} 
                                    <input type="radio" name="account" value="register_manual" id="register_manual" checked="checked" />
                                    {% else %} 
                                    <input type="radio" name="account" value="register_manual" id="register_manual" />
                                    {% endif %} 
                                    <b>{{ text_register_manual }}</b>
                                </label>
                                <br />
                            </div>  
                            {% endif %} 
                        </div>
                        <div id="supercheckout-login">
                            <div class="supercheckout-extra-wrap">
                                <b>{{ entry_password }}<span class="supercheckout-required">*</span></b><br />
                                <input type="password" id="password" name="password" value="" class="supercheckout-large-field" />
                                <br />
                                <div id="forgotpasswordlink"><a href="{{ forgotten }}">{{ text_forgotten }}</a></div>
                                <br />
                                <input type="button" value="{{ button_login }}" id="button-login" class="orangebuttonsmall" /><br />
                            </div>                        
                        </div> 
                        <div id="supercheckout-login-register-manual">
                                <input id="use_password" type="hidden" name="use_password" value="0" >
                                <div class="supercheckout-extra-wrap supercheckout_password_fields">
                                    <span class="supercheckout-login-label supercheckout_password_fields"><b>{{ entry_password }}<span class="supercheckout-required">*</span></b></span><br/>
                                    <span class="supercheckout-login-value">
                                        <input type="password" id="password_register" name="password_register" value="" class="supercheckout-large-field " />
                                    </span>
                                </div>
                                <div class="supercheckout-extra-wrap supercheckout_password_fields" style="/*float:left;*/">
                                    <span class="supercheckout-login-label"><b>{{ entry_confirm }}<span class="supercheckout-required">*</span></b></span><br/>
                                    <span class="supercheckout-login-value">
                                        <input type="password" id="confirm_password" name="confirm_password" value="" class="supercheckout-large-field " />
                                    </span>
                                </div> 
                                    
                                {% for custom_field in custom_fields %}    
                                {% if (custom_field['location'] == 'account') %}  
                                {% if (custom_field['type'] == 'text') %} 
                                <div class="supercheckout-extra-wrap custom-field" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    
                                    <span class="supercheckout-login-label"><b>{{ custom_field['name'] }}<span style="display:{% if (custom_field['required'] == 1) %}{{ "inline" }}{% else %} {{ "none" }}{% endif %}" class="supercheckout-required display_required{{ custom_field['custom_field_id'] }}">*</span></b></span><br/>   
                                    <span class="supercheckout-login-value">
                                        <input type="text" name="custom_field[{{custom_field['location']}}][{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}"  id="input-payment-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field account_custom_field" style="width: 97%;" data="{% if (custom_field['required'] == 1) %}{{ "required" }}{% else %} {{ "" }} {%endif%}"/>
                                    </span>
                                    <p style="color:red;" class="required_field{{ custom_field['custom_field_id'] }}"></p>
                                </div>
                                {% endif %} 
                                
                                {% if (custom_field['type'] == 'select') %} 
                                <div class="supercheckout-extra-wrap custom-field" id="custom-field{{ custom_field['custom_field_id'] }}">
                                        <b>{{ custom_field['name'] }}</b>
                                        <span style="display:{% if (custom_field['required'] == 1) %} {{'inline' }}{% else %} {{'none' }}{% endif %};" class="supercheckout-required display_required{{ custom_field['custom_field_id'] }}">*</span>
                                        <select name="custom_field[{{ custom_field['location'] }}][{{ custom_field['custom_field_id'] }}]" id="input-payment-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field account_custom_field">
                                          <option value="">{{ text_select }}</option>
                                          {% for custom_field_value in custom_field['custom_field_value'] %} 
                                          <option value="{{ custom_field_value['custom_field_value_id'] }}">{{ custom_field_value['name'] }}</option>
                                          {% endfor %} 
                                        </select>
                                </div>
                                {% endif %}
                                
                                {% endif %} 
                                {% endfor %}
                                
                                <div class="supercheckout-clear"></div>
                        </div>
                        {% if (facebook_enable or google_enable) %} 
                        <div class="orSeparator">
                            <span>{{ text_OR_separator }}</span>
                        </div>
                        <h3>{{ text_sign_in_with }}</h3>
                        <div class="socialNetwork">
                            {% if (facebook_enable) %} 
                            <div class="fbButton" id="fb-auth"></div>
                            {% endif %}{% if (google_enable) %} 
                            <div class="googleButton" onclick="window.open('{{ url }}', 'name','resizable=1,scrollbars=no,width=500,height=400')"></div>
                            {% endif %} 
                            <div class="supercheckout-clear"></div>
                        </div>
                        {% endif %} 
                        {% else %} 
                        <div class="myaccount">
                            <ol class="rectangle-list">                            
                                <li>
                                    <a href="{{ myAccount }}">{{ text_my_account }}</a>
                                </li>
    <!--                            <li style="float:left;">
                                    <a href="{{ myOrder }}">{{ text_my_orders }}</a>
                                </li>-->
                                <li>
                                    <a href="{{ logoutLink }}">{{ text_logout }}</a>
                                </li>
                                <div class="supercheckout-clear"></div>
                            </ol>
                        </div>
                        {% endif %} 
                    </div>
                    {% if (not logged) %}
                    <div class="customer_group" id="customer_group_div">
                        {% if (customer_groups is defined) %} 
                        <lable><b>{{ text_customer_groups }}</b></lable>
                        {% for all_groups in customer_groups %} 
                        
                        <div class="supercheckout-extra-wrap">
                                <label for="customer-groups{{ all_groups['customer_group_id'] }}">
                                    <input type="radio" name="customer_group_id" value="{{ all_groups['customer_group_id'] }}" id="customer-groups{{ all_groups['customer_group_id'] }}" />
                                    <b>{{ all_groups['name'] }}</b>
                                </label>
                                <br />
                            </div>
                        {% endfor %} {% endif %} 
                        </div>
                         {% else %}
                     <input type="hidden" name="customer_group_id" value="{{ customer_group_id }}" id="customer-groups{{ customer_group_id }}" />
                {% endif %}
                </div>
                <div  class="supercheckout-blocks"  data-column="{{ sort_block['payment_address'][layout_name]['column'] }}" data-row="{{ sort_block['payment_address'][layout_name]['row'] }}" data-column-inside="{{ sort_block['payment_address'][layout_name]['column-inside'] }}">
                    <ul>
                        <li>
                            <p class="supercheckout-numbers supercheckout-numbers-2">{{ text_billing_address }}</p>
                        </li>
                    </ul>
                    <div id="checkoutBillingAddress">
                        {% if (addresses) %} 
                        <div class="supercheckout-checkout-content">
                        </div>
                        <div class="supercheckout-extra-wrap">
                            <input type="radio" name="payment_address" value="existing" id="payment-address-existing" checked="checked" />
                            <label for="payment-address-existing">{{ text_address_existing }}</label>
                        </div>    
                        <div id="payment-existing">
                            <select name="address_id" id="payment_address_id_custom" style="opacity: 1 !important;height: 17px;width: 92%; margin-bottom: 15px;">
                                {% for address in addresses %} 
                                {% if (address['address_id'] == address_id) %} 
                                <option value="{{ address['address_id'] }}" selected="selected">{{ address['firstname'] }}{{ address['lastname'] }}, {{ address['company'] }}, {{ address['address_1'] }}, {{ address['city'] }}, {{ address['zone'] }}, {{ address['country'] }}</option>
                                {% else %} 
                                <option value="{{ address['address_id'] }}">{{ address['firstname'] }}{{ address['lastname'] }}, {{ address['company'] }}, {{ address['address_1'] }}, {{ address['city'] }}, {{ address['zone'] }}, {{ address['country'] }}</option>
                                {% endif %} 
                                {% endfor %} 
                            </select>
                        </div>
                        <div class="supercheckout-extra-wrap">
                            <p>
                                <input type="radio" name="payment_address" value="new" id="payment-address-new" />
                                <label for="payment-address-new">{{ text_address_new }}</label>
                            </p>
                        </div>
                        {% endif %} 
                        <div id="payment-new" style="display: {{ addresses ? 'none' : 'block' }};">
                            <table id="payment_address_table" class="supercheckout-form">
                                {% if (logged) %} 
                                    {% if (payment_address_sort_order['fields']['firstname']['sort_order'] - payment_address_sort_order['fields']['lastname']['sort_order'] == -1 and settings['option']['logged']['payment_address']['fields']['firstname']['display'] and settings['option']['logged']['payment_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (payment_address_sort_order['fields']['firstname']['sort_order'] - payment_address_sort_order['fields']['lastname']['sort_order'] == 1 and settings['option']['logged']['payment_address']['fields']['firstname']['display'] and settings['option']['logged']['payment_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['lastname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['payment_address']['fields']['firstname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            {{ entry_firstname }} 
                                            <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['payment_address']['fields']['lastname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['lastname']['sort_order'] }}">
                                        <td> 
                                            {{ entry_lastname }} 
                                            <span style="display:{% if (settings['option']['logged']['payment_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (payment_address_sort_order['fields']['firstname']['sort_order'] - payment_address_sort_order['fields']['lastname']['sort_order'] == -1 and settings['option']['guest']['payment_address']['fields']['firstname']['display'] and settings['option']['guest']['payment_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( payment_address_sort_order['fields']['firstname']['sort_order'] - payment_address_sort_order['fields']['lastname']['sort_order'] == 1 and settings['option']['guest']['payment_address']['fields']['firstname']['display'] and settings['option']['guest']['payment_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['lastname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['payment_address']['fields']['firstname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            {{ entry_firstname }} 
                                            <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="firstname" value="{% if (order_details['payment_firstname'] is defined) %}{{ order_details['payment_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['payment_address']['fields']['lastname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['lastname']['sort_order'] }}">
                                        <td> 
                                            {{ entry_lastname }} 
                                            <span style="display:{% if (settings['option']['guest']['payment_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="lastname" value="{% if (order_details['payment_lastname'] is defined) %}{{ order_details['payment_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['telephone']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['telephone']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['telephone']['sort_order'] }}">
                                    <td> 
                                        {{ entry_telephone }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['telephone']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['telephone']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="telephone" value="{% if (order_details['telephone'] is defined) %}{{ order_details['telephone'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['company']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['company']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['company']['sort_order'] }}" >
                                    <td>
                                        {{ entry_company }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['company']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['company']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="company" value="{% if (order_details['payment_company'] is defined) %}{{ order_details['payment_company'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>

                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['address_1']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['address_1']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['address_1']['sort_order'] }}" >
                                    <td> 
                                        {{ entry_address_1 }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['address_1']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['address_1']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="address_1" value="{% if (order_details['payment_address_1'] is defined) %}{{ order_details['payment_address_1'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['address_2']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['address_2']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['address_2']['sort_order'] }}" >
                                    <td>
                                         {{ entry_address_2 }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['address_2']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['address_2']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="address_2" value="{% if (order_details['payment_address_2'] is defined) %}{{ order_details['payment_address_2'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                {% if (logged) %} 
                                    {% if (payment_address_sort_order['fields']['postcode']['sort_order'] - payment_address_sort_order['fields']['city']['sort_order'] == -1 and settings['option']['logged']['payment_address']['fields']['postcode']['display'] and settings['option']['logged']['payment_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['postcode']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (payment_address_sort_order['fields']['postcode']['sort_order'] - payment_address_sort_order['fields']['city']['sort_order'] == 1 and settings['option']['logged']['payment_address']['fields']['postcode']['display'] and settings['option']['logged']['payment_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                    <td>
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['payment_address']['fields']['city']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            {{ entry_city }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                            <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['payment_address']['fields']['postcode']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['postcode']['sort_order'] }}">
                                        <td>
                                            {{ entry_postcode }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                            <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (payment_address_sort_order['fields']['postcode']['sort_order'] - payment_address_sort_order['fields']['city']['sort_order'] == -1 and settings['option']['guest']['payment_address']['fields']['postcode']['display'] and settings['option']['guest']['payment_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['postcode']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( payment_address_sort_order['fields']['postcode']['sort_order'] - payment_address_sort_order['fields']['city']['sort_order'] == 1 and settings['option']['guest']['payment_address']['fields']['postcode']['display'] and settings['option']['guest']['payment_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                    <td>
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['payment_address']['fields']['city']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            {{ entry_city }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                            <input type="text" name="city" value="{% if (order_details['payment_city'] is defined) %}{{ order_details['payment_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['payment_address']['fields']['postcode']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['postcode']['sort_order'] }}">
                                        <td>
                                            {{ entry_postcode }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="payment-postcode-required" class="supercheckout-required">*</span>
                                            <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %} 
                                {% for custom_field in custom_fields %} 
                                {% if (custom_field['location'] == 'address') %}
                                {% if (custom_field['type'] == 'select') %}
                                {% if (logged) %}
                                    {% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <select name="custom_field[{{ custom_field['custom_field_id'] }}]" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field">
                                          <option value="">{{ text_select }}</option>
                                          {% for custom_field_value in custom_field['custom_field_value'] %} 
                                          <option value="{{ custom_field_value['custom_field_value_id'] }}">{{ custom_field_value['name'] }}</option>
                                          {% endfor %} 
                                        </select>
                                  </td>
                                </tr>
                                    {% endif %}
                                {% else %}
                                    {% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                        <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                            <td>
                                                {{ custom_field['name'] }}
                                                <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                <select name="custom_field[{{ custom_field['custom_field_id'] }}]" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field">
                                                    <option value="">{{ text_select }}</option>
                                                    {% for custom_field_value in custom_field['custom_field_value'] %}
                                                        <option value="{{ custom_field_value['custom_field_value_id'] }}">{{ custom_field_value['name'] }}</option>
                                                    {% endfor %}
                                                </select>
                                            </td>
                                        </tr>
                                    {% endif %}
                                {% endif %}
                                {% endif %}
                                {% if (custom_field['type'] == 'radio') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> {{ custom_field['name'] }}<span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span><br><br>
                                        {% for custom_field_value in custom_field['custom_field_value'] %} 
                                        <input type="radio" name="custom_field[{{ custom_field['custom_field_id'] }}]" id="{{ custom_field['custom_field_id'] }} ?>_{{ custom_field['name'] }}" value="{{ custom_field_value['custom_field_value_id'] }}" class="supercheckout-large-field address_custom_field" />
                                        <label for="{{ custom_field['custom_field_id'] }}_{{ custom_field['name'] }}">
                                            {{ custom_field_value['name'] }}
                                        </label>
                                        <br>
                                        {% endfor %} 
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'checkbox') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span><br><br>
                                        {% for custom_field_value in custom_field['custom_field_value'] %} 
                                        <label>
                                          <input type="checkbox" name="custom_field[{{ custom_field['custom_field_id'] }}][]" value="{{ custom_field_value['custom_field_value_id'] }}" />
                                          {{ custom_field_value['name'] }} 
                                        </label>
                                        {% endfor %} 
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'text') %}
                                    {% if (logged) %}
                                        {% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                    <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                        <td>
                                            {{ custom_field['name'] }}
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field" style="height:23px;"/>
                                      </td>
                                    </tr>
                                        {% endif %}
                                    {% else %}
                                        {% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                            <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                                <td>
                                                    {{ custom_field['name'] }}
                                                    <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                    <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field" style="height:23px;"/>
                                                </td>
                                            </tr>
                                        {% endif %}
                                    {% endif %}
                                {% endif %} 
                                {% if (custom_field['type'] == 'textarea') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <textarea name="custom_field[{{ custom_field['custom_field_id'] }}]" style="width: 100%" rows="3"  placeholder="{{ custom_field['name'] }}" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field">{{ custom_field['value'] }}</textarea>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'file') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <button type="button" id="button-payment-custom-field{{ custom_field['custom_field_id'] }}" data-loading-text="{{ text_loading }}" class="btn btn-default"><i class="fa fa-upload"></i> {{ button_upload }}</button>
                                        <input type="hidden" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" />
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'date') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td>
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group date">
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="YYYY-MM-DD" readonly="" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                          <span class="input-group-btn">
                                          <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                          </span>
                                        </div>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'time') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group time">
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" readonly="" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="HH:mm" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                            <span class="input-group-btn">
                                            <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                            </span>
                                        </div>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'datetime') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][field]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ payment_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group datetime">
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" readonly="" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="YYYY-MM-DD HH:mm" id="input-address-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                            <span class="input-group-btn">
                                            <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                            </span>
                                        </div>
                                  </td>
                                </tr>
                                {% endif %} 
                                {% endif %} 
                                {% endfor %} 
                                {% if (logged) %} 
                                    {% if (payment_address_sort_order['fields']['zone_id']['sort_order'] - payment_address_sort_order['fields']['country_id']['sort_order'] == -1 and settings['option']['logged']['payment_address']['fields']['country_id']['display'] and settings['option']['logged']['payment_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %}                                        
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (payment_address_sort_order['fields']['zone_id']['sort_order'] - payment_address_sort_order['fields']['country_id']['sort_order'] == 1 and settings['option']['logged']['payment_address']['fields']['country_id']['display'] and settings['option']['logged']['payment_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %}                                        
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_country }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                <option value="">{{ text_select }}</option>
                                                {% for country in countries %}                                        
                                                {% if ((country['country_id'] == country_id)) %} 
                                                <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                {% else %} 
                                                <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                {% endif %} 
                                                {% endfor %} 
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_zone }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                {{ zones_default }} 
                                            </select>
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (payment_address_sort_order['fields']['zone_id']['sort_order'] - payment_address_sort_order['fields']['country_id']['sort_order'] == -1 and settings['option']['guest']['payment_address']['fields']['country_id']['display'] and settings['option']['guest']['payment_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %}                                        
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( payment_address_sort_order['fields']['zone_id']['sort_order'] - payment_address_sort_order['fields']['country_id']['sort_order'] == 1 and settings['option']['guest']['payment_address']['fields']['country_id']['display'] and settings['option']['guest']['payment_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ payment_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %}                                        
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_zone }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                {{ zones_default }} 
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ payment_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_country }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                <option value="">{{ text_select }}</option>
                                                {% for country in countries %}                                        
                                                {% if ((country['country_id'] == country_id)) %} 
                                                <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                {% else %} 
                                                <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                {% endif %} 
                                                {% endfor %} 
                                            </select>
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %} 
                            </table>
                        </div>
                        <ul>
                            <li>
                                <div class="input-box input-different-shipping" style="display:{% if (not logged) %}{% if (settings['option']['guest']['payment_address']['fields']['shipping']['display']) %}{{ 'block' }}{% else %}{{ 'none' }}{% endif %}{% else %}{% if (settings['option']['logged']['payment_address']['fields']['shipping']['display']) %}{{ 'block' }}{% else %}{{ 'none' }}{% endif %}{% endif %};">
                                    {% set checked_var='' %}{% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['shipping']['display'] is defined and settings['option']['logged']['payment_address']['fields']['shipping']['checked'] == "1") %}{% set checked_var='checked="checked"' %}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['shipping']['display'] is defined and settings['option']['guest']['payment_address']['fields']['shipping']['checked'] == "1") %}{% set checked_var='checked="checked"' %}{% endif %}{% endif %}
                                    <input name="use_for_shipping" id="shipping_use" {{ checked_var }} type="checkbox">
                                    {# } else { #}
                                    <!--<input name="use_for_shipping" id="shipping_use" type="checkbox">-->
                                    {# } #}
                                    <label for="shipping_use"><b>{{ text_ship_same_address }}</b></label>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <br/>
                </div>    
                <div class="supercheckout-blocks" data-column="{{ sort_block['shipping_address'][layout_name]['column'] }}" data-row="{{ sort_block['shipping_address'][layout_name]['row'] }}" data-column-inside="{{ sort_block['shipping_address'][layout_name]['column-inside'] }}">
                    <div id="checkoutShippingAddress" {% if (logged) %}{% if (settings['option']['logged']['payment_address']['fields']['shipping']['display'] is defined and settings['option']['logged']['payment_address']['fields']['shipping']['checked'] == "0") %}{{ 'style="display: block"' }}{% endif %}{% else %}{% if (settings['option']['guest']['payment_address']['fields']['shipping']['display'] is defined and settings['option']['guest']['payment_address']['fields']['shipping']['checked'] == "0") %}{{ 'style="display: block"' }}{% endif %}{% endif %}>
                        <div class="supercheckout-checkout-content">
                        </div>
                        <ul>
                            <li>
                                <p class="supercheckout-numbers supercheckout-numbers-ship">{{ text_shipping_address }}</p>
                            </li>
                        </ul>
                        {% if (addresses) %} 
                        <div class="supercheckout-extra-wrap">
                            <input type="radio" name="shipping_address" value="existing" id="shipping-address-existing" checked="checked" />
                            <label for="shipping-address-existing">{{ text_address_existing }}</label>
                        </div>
                        <div id="shipping-existing" class="styled-select">
                            <select name="address_id" id="shipping_address_id_custom" style="opacity: 1 !important;height: 17px;width: 92%; margin-bottom: 15px;">
                                {% for address in addresses %} 
                                {% if (address['address_id'] == ship_address_id) %} 
                                <option value="{{ address['address_id'] }}" selected="selected">{{ address['firstname'] }}{{ address['lastname'] }}, {{ address['company'] }}, {{ address['address_1'] }}, {{ address['city'] }}, {{ address['zone'] }}, {{ address['country'] }}</option>
                                {% else %} 
                                <option value="{{ address['address_id'] }}">{{ address['firstname'] }}{{ address['lastname'] }}, {{ address['company'] }}, {{ address['address_1'] }}, {{ address['city'] }}, {{ address['zone'] }}, {{ address['country'] }}</option>
                                {% endif %} 
                                {% endfor %} 
                            </select>
                        </div>
                        <div class="supercheckout-extra-wrap">
                            <p>
                                <input type="radio" name="shipping_address" value="new" id="shipping-address-new" />
                                <label for="shipping-address-new">{{ text_address_new }}</label>
                            </p>
                        </div>
                        {% endif %} 
                        <div id="shipping-new"style="display: {{ addresses ? 'none' : 'block' }};">
                            <table class="supercheckout-form" id="shipping_address_table">
                                {% if (logged) %} 
                                    {% if (shipping_address_sort_order['fields']['firstname']['sort_order'] - shipping_address_sort_order['fields']['lastname']['sort_order'] == -1 and settings['option']['logged']['shipping_address']['fields']['firstname']['display'] and settings['option']['logged']['shipping_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (shipping_address_sort_order['fields']['firstname']['sort_order'] - shipping_address_sort_order['fields']['lastname']['sort_order'] == 1 and settings['option']['logged']['shipping_address']['fields']['firstname']['display'] and settings['option']['logged']['shipping_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['lastname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td> 
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_firstname }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['lastname']['sort_order'] }}">
                                        <td> 
                                            {{ entry_lastname }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (shipping_address_sort_order['fields']['firstname']['sort_order'] - shipping_address_sort_order['fields']['lastname']['sort_order'] == -1 and settings['option']['guest']['shipping_address']['fields']['firstname']['display'] and settings['option']['guest']['shipping_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( shipping_address_sort_order['fields']['firstname']['sort_order'] - shipping_address_sort_order['fields']['lastname']['sort_order'] == 1 and settings['option']['guest']['shipping_address']['fields']['firstname']['display'] and settings['option']['guest']['shipping_address']['fields']['lastname']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['lastname']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_lastname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_firstname }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields']['firstname']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_firstname }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['firstname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="firstname" value="{% if (order_details['shipping_firstname'] is defined) %}{{ order_details['shipping_firstname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['lastname']['sort_order'] }}">
                                        <td> 
                                            {{ entry_lastname }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['lastname']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <input type="text" name="lastname" value="{% if (order_details['shipping_lastname'] is defined) %}{{ order_details['shipping_lastname'] }}{% endif %}" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %}
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['address_1']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['address_1']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['address_1']['sort_order'] }}">
                                    <td>
                                        {{ entry_address_1 }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['address_1']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['address_1']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span> 
                                        <input type="text" name="address_1" value="{% if (order_details['shipping_address_1'] is defined) %}{{ order_details['shipping_address_1'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['address_2']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['address_2']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['address_2']['sort_order'] }}">
                                    <td>
                                        {{ entry_address_2 }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['address_2']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['address_2']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="address_2" value="{% if (order_details['shipping_address_2'] is defined) %}{{ order_details['shipping_address_2'] }}{% endif %}" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                {% if (logged) %} 
                                    {% if (shipping_address_sort_order['fields']['postcode']['sort_order'] - shipping_address_sort_order['fields']['city']['sort_order'] == -1 and settings['option']['logged']['shipping_address']['fields']['postcode']['display'] and settings['option']['logged']['shipping_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['postcode']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (shipping_address_sort_order['fields']['postcode']['sort_order'] - shipping_address_sort_order['fields']['city']['sort_order'] == 1 and settings['option']['logged']['shipping_address']['fields']['postcode']['display'] and settings['option']['logged']['shipping_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                    <td>
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['shipping_address']['fields']['city']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            {{ entry_city }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                            <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['postcode']['sort_order'] }}">
                                        <td>
                                            {{ entry_postcode }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                            <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (shipping_address_sort_order['fields']['postcode']['sort_order'] - shipping_address_sort_order['fields']['city']['sort_order'] == -1 and settings['option']['guest']['shipping_address']['fields']['postcode']['display'] and settings['option']['guest']['shipping_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['postcode']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                    <td>
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( shipping_address_sort_order['fields']['postcode']['sort_order'] - shipping_address_sort_order['fields']['city']['sort_order'] == 1 and settings['option']['guest']['shipping_address']['fields']['postcode']['display'] and settings['option']['guest']['shipping_address']['fields']['city']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important">
                                                        {{ entry_city }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                                        <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                                    </td>
                                                    <td>
                                                        {{ entry_postcode }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                                        <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['shipping_address']['fields']['city']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields']['city']['sort_order'] }}" >
                                        <td>
                                            {{ entry_city }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['city']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="city" class="supercheckout-large-field js-example-basic-single form-control"></select>
{#                                            <input type="text" name="city" value="{% if (order_details['shipping_city'] is defined) %}{{ order_details['shipping_city'] }}{% endif %}" class="supercheckout-large-field" />#}
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['postcode']['sort_order'] }}">
                                        <td>
                                            {{ entry_postcode }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['postcode']['require'] and country_info_guest['postcode_required']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" id="shipping-postcode-required" class="supercheckout-required">*</span>
                                            <input type="text" name="postcode" value="" class="supercheckout-large-field" />
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %} 
                                
                                {% for custom_field in custom_fields %} 
                                {% if (custom_field['location'] == 'address') %} 
                                {% if (custom_field['type'] == 'select') %}
                                {% if (logged) %}
                                    {% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <select name="shipping_custom_field[{{ custom_field['custom_field_id'] }}]" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field shipping_address_custom_field">
                                          <option value="">{{ text_select }}</option>
                                          {% for custom_field_value in custom_field['custom_field_value'] %} 
                                          <option value="{{ custom_field_value['custom_field_value_id'] }}">{{ custom_field_value['name'] }}</option>
                                          {% endfor %} 
                                        </select>
                                  </td>
                                </tr>
                                    {% endif %}
                                {% else %}
                                    {% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                        <tr class="sort_data custom-field aint" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                            <td>
                                                {{ custom_field['name'] }}
                                                <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                <select name="shipping_custom_field[{{ custom_field['custom_field_id'] }}]" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field shipping_address_custom_field">
                                                    <option value="">{{ text_select }}</option>
                                                    {% for custom_field_value in custom_field['custom_field_value'] %}
                                                        <option value="{{ custom_field_value['custom_field_value_id'] }}">{{ custom_field_value['name'] }}</option>
                                                    {% endfor %}
                                                </select>
                                            </td>
                                        </tr>
                                    {% endif %}
                                {% endif %}
                                {% endif %}
                                {% if (custom_field['type'] == 'radio') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span><br><br>
                                        {% for custom_field_value in custom_field['custom_field_value'] %} 
                                        <input type="radio" name="custom_field[{{ custom_field['custom_field_id'] }}]" id="{{ field }}_{{ value['name'] }}" value="{{ custom_field_value['custom_field_value_id'] }}" class="supercheckout-large-field address_custom_field" />
                                        <label for="{{ custom_field['custom_field_id'] }}_{{ custom_field['name'] }}">
                                            {{ custom_field_value['name'] }}
                                        </label>
                                        <br>
                                        {% endfor %} 
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'checkbox') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span><br><br>
                                        {% for custom_field_value in custom_field['custom_field_value'] %} 
                                        <label>
                                          <input type="checkbox" name="custom_field[{{ custom_field['custom_field_id'] }}][]" value="{{ custom_field_value['custom_field_value_id'] }}" />
                                          {{ custom_field_value['name'] }} 
                                        </label>
                                        {% endfor %} 
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'text') %}
                                    {% if (logged) %}
                                        {% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <input type="text" name="shipping_custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field shipping_address_custom_field" />
                                    </td>
                                </tr>
                                        {% endif %}
                                    {% else %}
                                        {% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}
                                            <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                                <td>
                                                    {{ custom_field['name'] }}
                                                    <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                    <input type="text" name="shipping_custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field shipping_address_custom_field" />
                                                </td>
                                            </tr>
                                        {% endif %}
                                    {% endif %}
                                {% endif %} 
                                {% if (custom_field['type'] == 'textarea') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }}
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <textarea name="custom_field[{{ custom_field['custom_field_id'] }}]" style="width: 100%" rows="3"  placeholder="{{ custom_field['name'] }}" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field address_custom_field">{{ custom_field['value'] }}</textarea>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'file') %} 
                                <tr class="sort_data custom-field" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" id="shipping_custom-field{{ custom_field['custom_field_id'] }}">
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <button type="button" id="button-payment-custom-field{{ custom_field['custom_field_id'] }}" data-loading-text="{{ text_loading }}" class="btn btn-default"><i class="fa fa-upload"></i> {{ button_upload }}</button>
                                        <input type="hidden" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" />
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'date') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group date">
                                          <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="YYYY-MM-DD" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                          <span class="input-group-btn">
                                          <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                          </span>
                                        </div>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'time') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group time">
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="HH:mm" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                            <span class="input-group-btn">
                                            <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                            </span>
                                        </div>
                                    </td>
                                </tr>
                                {% endif %} 
                                {% if (custom_field['type'] == 'datetime') %} 
                                <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][field]['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};"  data-percentage="{{ shipping_address_sort_order['fields'][custom_field['custom_field_id']]['sort_order'] }}" >
                                    <td> 
                                        {{ custom_field['name'] }} 
                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields'][custom_field['custom_field_id']]['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                        <div class="input-group datetime">
                                            <input type="text" name="custom_field[{{ custom_field['custom_field_id'] }}]" value="{{ custom_field['value'] }}" placeholder="{{ custom_field['name'] }}" data-date-format="YYYY-MM-DD HH:mm" id="input-shipping-custom-field{{ custom_field['custom_field_id'] }}" class="supercheckout-large-field" />
                                            <span class="input-group-btn">
                                            <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
                                            </span>
                                        </div>
                                  </td>
                                </tr>
                                {% endif %} 
                                {% endif %} 
                                {% endfor %}
                                <tr>
                                    <td>
                                        {{ entry_company }}
                                        <input type="text" name="shipping_company" value="" class="supercheckout-large-field" />
                                    </td>
                                </tr>
                                {% if (logged) %} 
                                    {% if (shipping_address_sort_order['fields']['zone_id']['sort_order'] - shipping_address_sort_order['fields']['country_id']['sort_order'] == -1 and settings['option']['logged']['shipping_address']['fields']['country_id']['display'] and settings['option']['logged']['shipping_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %} 
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif (shipping_address_sort_order['fields']['zone_id']['sort_order'] - shipping_address_sort_order['fields']['country_id']['sort_order'] == 1 and settings['option']['logged']['shipping_address']['fields']['country_id']['display'] and settings['option']['logged']['shipping_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %} 
                                                            {% if ((country['country_id'] == country_id)) %} 
                                                            <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                            {% else %} 
                                                            <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                            {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_country }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="country_id" class="supercheckout-large-field js-example-basic-single">
                                                <option value="">{{ text_select }}</option>
                                                {% for country in countries %} 
                                                    {% if ((country['country_id'] == country_id)) %} 
                                                        <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                    {% else %} 
                                                        <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                    {% endif %} 
                                                {% endfor %} 
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_zone }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="zone_id" class="supercheckout-large-field js-example-basic-single">
                                                {{ zones_default }} 
                                            </select>
                                        </td>
                                    </tr>
                                    {% endif %} 
                                    <!--For not logged in--> 
                                {% else %} 
                                    {% if (shipping_address_sort_order['fields']['zone_id']['sort_order'] - shipping_address_sort_order['fields']['country_id']['sort_order'] == -1 and settings['option']['guest']['shipping_address']['fields']['country_id']['display'] and settings['option']['guest']['shipping_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td>
                                            <table>
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %} 
                                                                {% if ((country['country_id'] == country_id)) %} 
                                                                    <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                                {% else %} 
                                                                    <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                                {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% elseif ( shipping_address_sort_order['fields']['zone_id']['sort_order'] - shipping_address_sort_order['fields']['country_id']['sort_order'] == 1 and settings['option']['guest']['shipping_address']['fields']['country_id']['display'] and settings['option']['guest']['shipping_address']['fields']['zone_id']['display']) %} 
                                    <tr class="sort_data"  data-percentage="{{ shipping_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td>
                                            <table style="width:100%">
                                                <tr>
                                                    <td style="width: 50% !important"> 
                                                        {{ entry_country }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="country_id" class="supercheckout-large-field js-example-basic-single">
                                                            <option value="">{{ text_select }}</option>
                                                            {% for country in countries %} 
                                                                {% if ((country['country_id'] == country_id)) %} 
                                                                    <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                                {% else %} 
                                                                    <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                                {% endif %} 
                                                            {% endfor %} 
                                                        </select>
                                                    </td>
                                                    <td> 
                                                        {{ entry_zone }} 
                                                        <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                                        <select name="zone_id" class="supercheckout-large-field js-example-basic-single">
                                                            {{ zones_default }} 
                                                        </select>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    {% else %} 
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['country_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_country }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['country_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="country_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                <option value="">{{ text_select }}</option>
                                                {% for country in countries %} 
                                                    {% if ((country['country_id'] == country_id)) %} 
                                                        <option value="{{ country['country_id'] }}" selected="selected">{{ country['name'] }}</option>
                                                    {% else %} 
                                                        <option value="{{ country['country_id'] }}">{{ country['name'] }}</option>
                                                    {% endif %} 
                                                {% endfor %} 
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="sort_data" style="padding-left: 5px;display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};" data-percentage="{{ shipping_address_sort_order['fields']['zone_id']['sort_order'] }}" >
                                        <td> 
                                            {{ entry_zone }} 
                                            <span style="display:{% if (logged) %}{% if (settings['option']['logged']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['shipping_address']['fields']['zone_id']['require']) %}{{'inline' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-required">*</span>
                                            <select name="zone_id" class="supercheckout-large-field js-example-basic-single" style="opacity: 1 !important;height: 17px;">
                                                {{ zones_default }} 
                                            </select>
                                        </td>
                                    </tr>
                                    {% endif %} 
                                {% endif %} 
                            </table>
                        </div>
                    </div>                   
                </div>
                {% if (settings['step']['shipping_method']['display_options'] is defined and settings['step']['shipping_method']['display_options'] == 1) %} 
                <div  class="supercheckout-blocks" data-column="{{ sort_block['shipping_method'][layout_name]['column'] }}" data-row="{{ sort_block['shipping_method'][layout_name]['row'] }}" data-column-inside="{{ sort_block['shipping_method'][layout_name]['column-inside'] }}" >
                    <ul>
                        <li style="display:inline;">
                            <p class="supercheckout-numbers supercheckout-numbers-3">{{ text_shipping_method }}</p>
                            <div class="loader" id="shippingMethodLoader"></div>
                        </li>                
                    </ul>
                    <div id="shipping-method">
                        {% if (not shipping_required) %} 
                        <div class="supercheckout-checkout-content" style="display:block">
                            <div class="permanent-warning" style="display: block;">No shipping required with these product(s).<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>
                        </div>
                        {% endif %} 
                        {% if (error_warning_shipping) %} 
                        <div class="supercheckout-checkout-content" style="display:block">
                            <div class="warning" style="display: block;">{{ error_warning_shipping }}<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>
                        </div>
                        {% endif %} 
                        <div class="supercheckout-checkout-content">
                        </div>
                        {% if (error_warning) %} 
                        <div class="warning">{{ error_warning }}</div>
                        {% endif %} 
                        {% if (shipping_methods is defined and shipping_methods and shipping_required) %} 
                        <table class="radio">
                            {% set all_shipping_code = [] %}
                            {% for shipping_method in shipping_methods %} 
                               {% for quote in shipping_method['quote'] %} 
                                   {% set all_shipping_code = all_shipping_code|merge([quote['code']]) %}
                               {% endfor %}
                           {% endfor %}
                           {% if codeShipping not in all_shipping_code %}
                               {% set codeShipping='' %}
                           {% endif %}

                            {% for key,shipping_method in shipping_methods %} 
                                {% if (not shipping_method['error']) %}
                                    {% if (settings['step']['shipping_method']['display_title'] is defined and settings['step']['shipping_method']['display_title']) %} 
                                    <tr>
                                        <td colspan="3"><b>{{ settings['step']['shipping_method']['title'][key~'.'~key][language_id] is defined ? settings['step']['shipping_method']['title'][key~'.'~key][language_id] : shipping_method['title'] }}</b></td>
                                    </tr>
                                    {% endif %} 
                                    {% for quote in shipping_method['quote'] %} 
                                        <tr class="highlight">
                                            <td style="align-items: ">
                                                {% if (quote['code'] == codeShipping or codeShipping == '') %} 
                                                    {% set codeShipping = quote['code'] %} 
                                                    <input type="radio" name="shipping_method" value="{{ quote['code'] }}" id="{{ quote['code'] }}" checked="checked" />
                                                {% else %} 
                                                    <input type="radio" name="shipping_method" value="{{ quote['code'] }}" id="{{ quote['code'] }}" />
                                                {% endif %} 
                                            </td>
                                            <td>
                                                
                                                <label for="{{ quote['code'] }}">
                                                {% if (settings['shipping_logo']['default_option'] == 'imageonly' and settings['step']['shipping_method']['logo'][quote['code']] is not empty and shipping_logo[quote['code']]) %} 

                                                    {{ '<a title="'~quote['title']~'"><img src="image/'~settings['step']['shipping_method']['logo'][quote['code']]~'" alt="'~quote['title']~'" style="max-width: 100px;max-height: 100px" /></a>' }}
                                                    {{ '<label style="display: inline;" for="'~quote['code']~'">&nbsp&nbsp'~quote['text']~'</label>' }}
                                                    
                                                {% elseif (settings['shipping_logo']['default_option'] == 'textwithimage' and settings['step']['shipping_method']['logo'][quote['code']] is not empty and shipping_logo[quote['code']]) %}

                                                    {{ '<a title="'~quote['title']~'"><img src="image/'~settings['step']['shipping_method']['logo'][quote['code']]~'" alt="'~quote['title']~'" style="max-width: 100px;max-height: 100px" /></a><br>' }}
                                                    {{ quote['title'] }}
                                                    {{ '<label style="display: inline;" for="'~quote['code']~'">&nbsp&nbsp'~quote['text']~'</label>' }}
                                                {% else %} 
                                                    {{ quote['title'] }}
                                                    {{ '<label style="display: inline;" for="'~quote['code']~'">&nbsp&nbsp'~quote['text']~'</label>' }}
                                                {% endif %} 
                                                </label>
                                            </td>
                                            <!--<td style="text-align: right;" class="price"><label for="{# echo $quote['code']; #}">{# echo $quote['text']; #}</label></td>-->
                                        </tr>
                                    {% endfor %} 
                                {% else %} 
                                    <tr>
                                        <td colspan="3"><div class="error">{{ shipping_method['error'] }}</div></td>
                                    </tr>
                                {% endif %} 
                            {% endfor %} 
                        </table>
                        <br />
                        {% endif %} 
                    </div>
                </div>
                {% endif %}
                {% if (settings['step']['payment_method']['display_options'] == 1) %} 
                <div  class="supercheckout-blocks" data-column="{{ sort_block['payment_method'][layout_name]['column'] }}" data-row="{{ sort_block['payment_method'][layout_name]['row'] }}" data-column-inside="{{ sort_block['payment_method'][layout_name]['column-inside'] }}">
                    <ul>
                        <li>
                            <p class="supercheckout-numbers supercheckout-numbers-4">{{ text_payment_method }}</p>
                            <div class="loader" id="paymentMethodLoader"></div>
                        </li>                
                    </ul>
                    <div id="payment-method">
                        <div class="supercheckout-checkout-content">
                        </div>
                        {% if (error_warning) %} 
                                <div class="warning">{{ error_warning }}</div>
                        {% endif %} 
                        {% if (payment_methods is defined and payment_methods) %}                 
                        <table class="radio">
                            {% set all_payment_code = [] %}
                            {% for payment_method in payment_methods %} 
                                {% set all_payment_code = all_payment_code|merge([payment_method['code']]) %}
                            {% endfor %}
                            {% if (not (code in all_payment_code)) %}{% set code='' %}
                            {% endif %}
                            {% for payment_method in payment_methods %} 
                            <tr class="highlight" id="{{ payment_method['code'] }}">
                                <td>
                                    {% if (payment_method['code'] == code or not code) %} 
                                        {% set code = payment_method['code'] %} 
                                        {% if (settings['payment_logo']['default_option'] == 'textwithimage') %}
                                        {{ '<br>' }}
                                        {% endif %} 
                                        <input type="radio" name="payment_method" value="{{ payment_method['code'] }}" id="{{ payment_method['code'] }}"  checked="checked" />
                                    {% else %} 
                                        {% if (settings['payment_logo']['default_option'] == 'textwithimage') %}
                                        {{ '<br>' }}
                                        {% endif %} 
                                        <input type="radio" name="payment_method" value="{{ payment_method['code'] }}" id="{{ payment_method['code'] }}"  />
                                    {% endif %} 
                                </td>
                                <td>
                                    <label for="{{ payment_method['code'] }}">

                                            {% if (settings['payment_logo']['default_option'] == 'imageonly' and settings['step']['payment_method']['logo'][payment_method['code']] is not empty and payment_logo[payment_method['code']]) %} 

                                                {% if (payment_method['code'] == 'klarna_invoice') %}
                                                    {{ '<a><img src="image/'~settings['step']['payment_method']['logo'][payment_method['code']]~'" style="max-width: 100px;max-height: 100px"/></a>' }}
                                                {% else %} 
                                                    {{ '<a title="'~payment_method['title']~'"><img src="image/'~settings['step']['payment_method']['logo'][payment_method['code']]~'" alt="'~payment_method['title']~'" style="max-width: 100px;max-height: 100px"/></a>' }}
                                                {% endif %}
                                            {% elseif (settings['payment_logo']['default_option'] == 'textwithimage' and settings['step']['payment_method']['logo'][payment_method['code']] is not empty and payment_logo[payment_method['code']]) %}

                                                {% if (payment_method['code'] == 'klarna_invoice') %}
                                                    {{ '<a><img src="image/'~settings['step']['payment_method']['logo'][payment_method['code']]~'" style="max-width: 100px;max-height: 100px" /></a><br>' }}
                                                    {{ settings['step']['payment_method']['title'][payment_method['code']][language_id] is defined ? settings['step']['payment_method']['title'][payment_method['code']][language_id] : payment_method['title'] }}
                                                {% else %} 
                                                    {{ '<a title="'~payment_method['title']~'"><img src="image/'~settings['step']['payment_method']['logo'][payment_method['code']]~'" alt="'~payment_method['title']~'" style="max-width: 100px;max-height: 100px" /></a><br>' }}
                                                    {{ settings['step']['payment_method']['title'][payment_method['code']][language_id] is defined ? settings['step']['payment_method']['title'][payment_method['code']][language_id] : payment_method['title'] }}
                                                {% endif %}
                                            {% else %} 
                                                {{ settings['step']['payment_method']['title'][payment_method['code']][language_id] is defined ? settings['step']['payment_method']['title'][payment_method['code']][language_id] : payment_method['title'] }}
                                            {% endif %}
                                    </label>
                                </td>
                            </tr>
                            {% endfor %}
                        </table>                 
                         {% else %} 
                            {{ '<font style="color: red">'~text_shipping_not_available~'</font>' }} 
                        {% endif %} 
                    </div>
                </div>
                {% endif %}
                <div class="supercheckout-blocks confirmCheckoutBack" data-column="{{ sort_block['cart'][layout_name]['column'] }}" data-row="{{ sort_block['cart'][layout_name]['row'] }}" data-column-inside="{{ sort_block['cart'][layout_name]['column-inside'] }}" style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};">
                    <ul>
                        <li>
                            <p class="supercheckout-numbers supercheckout-check">{{ text_confirm_order }}</p>
                            <div class="loader" id="confirmLoader"></div>
                        </li>
                    </ul>
                    <div id="confirmCheckout">
                        <div class="supercheckout-checkout-content">
                        </div>
                        {% if (redirect is not defined) %} 
                        <table class="supercheckout-summary">
                            <thead>
                                <tr><th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-name"></th>
                                    <th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-name">{{ column_name }}</th>
                                    <th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['model']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['model']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-qty">{{ column_model }}</th>
                                    <th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['quantity']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['quantity']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-qty">{{ column_quantity }}</th>
                                    <th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['price']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['price']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-total" style="text-align:center;">{{ column_price }}</th>
                                    <th style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['total']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['total']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-total">{{ column_total }}</th>
                                    <th class="supercheckout-qty">{{ column_action }}</th>
                                </tr>
                            </thead>
                            <tbody> 
                                 {% for product in products %} 
                                <tr>
                                    <td>
                                        <div>
                                            <a href="{{ product['href'] }}"><img src='{{ product["thumb"] }}' height="100" width="100"></a>
                                        </div>
                                    </td>
                                    <td style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['name']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-name">
                                        <div >
                                            <a {% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['image']) %}{{'data-toggle="popover"' }}{% else %}{{'' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['image']) %}{{'data-toggle="popover"' }}{% else %}{{'' }}{% endif %}{% endif %} data-title="{{ product['name'] }}" data-content="<img src='{{ product['thumb'] }}' />" data-placement="right" href="{{ product['href'] }}">{{ product['name'] }}</a>
                                            {% for option in product['option'] %} 
                                            <br />
                                            &nbsp;<small> - {{ option['name'] }}: {{ option['value'] }}</small>
                                            {% endfor %} 
                                        </div>
                                    </td>
                                    <td style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['model']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['model']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-qty">
                                        {{ product['model'] }}{% if (product['reward'] and logged) %}{{ '<br><div style="color: #696969 !important;">('~text_rewards_point~product['reward']~')</div>' }}{% endif %} 
                                    </td> 
                                    <td style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['quantity']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['quantity']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-qty">
                                        <input class="quantitybox" type="text" name="quantity[{{ product['key'] }}]" value="{{ product['quantity'] }}" ><br>
                                        <a href="javascript://" id="{{ product['key'] }}" onclick="updateQuantity(this.id);" ><small>{{ button_update_link }}</small></a>
                                    </td>
                                    <td style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['price']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['price']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-total">
                                        {{ product['price'] }} 
                                    </td>
                                    <td style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['columns']['total']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['columns']['total']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};" class="supercheckout-total">
                                        {{ product['total'] }} 
                                    </td>
                                    <td class="supercheckout-qty">
                                        <a href="javascript://" id="{{ product['key'] }}" onclick="removeProduct(this.id);" class="removeProduct">
                                            <div id="{{ product['key'] }}"  title="Delete"></div>
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %} 
                                {% for voucher in vouchers %} 
                                <tr>
                                    <td class="supercheckout-name">{{ voucher['description'] }}</td>
                                    <td class="supercheckout-qty">1</td>
                                    <td class="supercheckout-total">{{ voucher['amount'] }}</td>
                                    <td class="supercheckout-total">{{ voucher['amount'] }}</td>
                                </tr>
                                {% endfor %} 
                            </tbody>                    
                        </table>
                        <table class="supercheckout-totals">
                            <tbody>
                                {% for datatotals in datatotal %} 
                                <tr>
                                    <td class="title"><b>{{ datatotals['title'] }}
                                            {% if (datatotals['code'] == 'voucher' or datatotals['code'] == 'coupon' or datatotals['code'] == 'reward') %}
                                                {{'<a href="javascript://" id="'~datatotals['code']~'" onclick="redeem(this.id);" ><div title="'~text_redeem~'" class="removeProduct"></div></a></td>' }}
                                            {% endif %}</b></td>
                                    <td class="value"><span class="price">{{ datatotals['text'] }}</span> </td>                                
                                </tr>
                                {% endfor %} 
                                <tr style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['option']['coupon']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['option']['coupon']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};">
                                    <td class="title">
                                        <b>{{ text_coupon_code }}</b>
                                    </td>
                                    <td class="value"><input  id="coupon_code" name="coupon" type="text" class="voucherText">
                                        <input type="hidden" value="coupon" name="next">
                                        <input id="button-coupon" type="button" onClick=" callCoupon();" class="orangebuttonapply" value="{{ button_apply }}">
                                    </td>
                                </tr>
                                <tr style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['option']['voucher']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['cart']['option']['voucher']['display']) %}{{' ' }}{% else %}{{'none' }}{% endif %}{% endif %};">
                                    <td class="title">
                                        <b>{{ text_voucher_code }}</b>
                                    </td>
                                    <td class="value"><input  id="voucher_code" name="voucher" type="text" class="voucherText">
                                        <input type="hidden" value="voucher" name="next">
                                        <input id="button-voucher" type="button" onClick="callVoucher();" class="orangebuttonapply" value="{{ button_apply }}">
                                    </td>
                                </tr>
                                 <tr style="display:{% if (logged) %}{% if (settings['option']['logged']['cart']['option']['reward']['display'] and customer_available_points and total_product_points) %}{{ 'block' }}{% endif %}{% endif %}{{ 'none' }};">
                                    <td class="title">
                                        <b>{{ text_rewards_point}}</b>
                                        {{ '<br>'~text_available_rewards_point~customer_available_points~'<br>'~text_max_rewards_point~total_product_points~')' }}
                                    </td>
                                    <td class="value"><input  id="rewards_point" name="rewards" type="text" class="voucherText">
                                        <input type="hidden" value="rewards_point" name="next">
                                       {# #} <input id="button-reward" type="button" onClick="callReward();" class="orangebuttonapply" value="{{ button_apply }}"> 
                                    </td>
                                </tr>
                            </tbody>
                        </table>            
                        {% endif %} 
                    </div>
                </div>
                <div id="payment_display_block"  class="supercheckout-blocks" data-column="{{ sort_block['confirm'][layout_name]['column'] }}" data-row="{{ sort_block['confirm'][layout_name]['row'] }}" data-column-inside="{{ sort_block['confirm'][layout_name]['column-inside'] }}" >
                    <div class="supercheckout-checkout-content"> </div>
                    <div id="display_payment">
                        {% if (payment_display is defined) %} 
                        {{ payment_display }} 
                        {% endif %} 
                    </div>
                    <div id="supercheckout-comments" style="display: {% if (logged) %}{% if (settings['option']['logged']['confirm']['fields']['comment']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['confirm']['fields']['comment']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};">
                        <b>{{ text_comments }}</b>
                        <textarea id="supercheckout-comment_order" name="comment" rows="8" ></textarea>
                        <br />
                        <br />
                    </div>

                    <!-- Newsletter subscription -->
                    <div id="newsletter_checkbox" style="display:none;"> 
                        <input id="newsletter" type="checkbox"  name="subscribe_newsletter" value="0" /> {{ subscribe_newsletter }} 
                    </div>
                    {% if (text_agree) %}                
                    <div id="supercheckout-agree" style="display:{% if (logged) %}{% if (settings['option']['logged']['confirm']['fields']['agree']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% else %}{% if (settings['option']['guest']['confirm']['fields']['agree']['display']) %}{{'block' }}{% else %}{{'none' }}{% endif %}{% endif %};">
                        {% if (agree) %} 
                            <input type="checkbox" name="agree" value="1" checked="checked" />
                        {% else %} 
                            <input type="checkbox" name="agree" value="1" />
                        {% endif %}
                        <p style="display: inline-block;cursor: pointer" data-toggle="modal" data-target="#agree-model">
                            {{ " "~text_agree }}
                        </p>
                    </div>                
                    {% endif %} 
                    <div id="supercheckout-privacy-policy" style="display: none">
                        <label>
                        <input type="checkbox" name="privacy" value="1" />
                        <p style="display: inline-block;cursor: pointer" data-toggle="modal" data-target="#privacy-model">
                        {{ text_privacy }}
                        </p>
                        </label>
                    </div>
                    <div id="placeorderButton">
                        <div id="buttonWithProgres" style="width:206px;">
                            <div  id="confirm_order" class="orangebutton" >
                                {{ button_place_order }} 
                                <div id="progressbar" style="text-align:center;margin-top: 0px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                {% for sort_html in sort_block['html'] %} 
                <div  class="supercheckout-blocks" data-column="{{ sort_html[layout_name]['column'] }}" data-row="{{ sort_html[layout_name]['row'] }}" data-column-inside="{{ sort_html[layout_name]['column-inside'] }}">
                    {% if (sort_html['value'] is defined) %}{{ (sort_html['value'] ) }}{% endif %}                
                </div>
                {% endfor %} 
            </div>

            <div class="supercheckout-column-middle columnleftsort" id="columnleft-2"  style="width:{% set i= settings['general']['column_width'][layout_name][2]*multiplier %}{{ i }}%;margin-right:0px;">
                <div class="supercheckout-column-left columnleftsort" id="column-2-upper" style="width:100%;height:auto;"> 
                </div>
                <div class="supercheckout-column-left columnleftsort" id="column-1-inside" style="width:{% set i= settings['general']['column_width'][layout_name]['inside'][1] * 0.914 %}{{ i }}%"> 
                </div>
                <div class="supercheckout-column-left columnleftsort" id="column-2-inside"  style="width:{% set i= settings['general']['column_width'][layout_name]['inside'][2] * 0.914 %}{{ i }}%">
                </div>
                <div class="supercheckout-column-left columnleftsort" id="column-2-lower"  style="width:100%;height:auto;">
                </div>
            </div>
            <div class="supercheckout-column-right columnleftsort" id="columnleft-3" style="width:{% set i= settings['general']['column_width'][layout_name][3]*multiplier %}{{ i }}%">
            </div>   
        </div>
    </fieldset>
</div>
    <div class="modal fade" id="agree-model" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    {{ terms_and_condition }}
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="privacy-model" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    {{ privacy_policy }}
                </div>
            </div>
        </div>
    </div>
{% if (settings['step']['html_value']['value']['footer'] is defined and settings['step']['html_value']['value']['footer'] != "") %} 
    <div id="supercheckout_html_content_footer">        
        {{ ( settings['step']['html_value']['value']['footer']) }} 
    </div>
{% endif %} 
</div>
<script type="text/javascript">
    $("#confirm_order").click(function() {
 if($("#register_manual").is(':checked') || $("#guest").is(':checked')){
            $('.account_custom_field').each(function(){
                var getid = $(this).attr('id');
                
                var idrequired = $('#'+getid).attr('data');
                if(idrequired == 'required'){
                    if($('#'+getid).val() == ''){
                        
                        $('#mandatory_field_error_'+getid).remove();
                        var error_msg = "{{error_required}}";
                        $('#'+getid).after('<p style="color:red !important;" id="mandatory_field_error_'+getid+'">'+ error_msg +'</p>');
                    } else {
                        $('#mandatory_field_error_'+getid).remove();
                    }
                }
            });
        } else {
            $("[id^='mandatory_field_error']").remove();
        }
        
        if($("[id^='mandatory_field_error']").length > 0){
            goToByScroll('mandatory_field_error');            
            return false;   
        } 
        $('.warning, .error').remove();
        var flag = true;
        var error = '';
        var agreeRequire="{{ agree_require }}";
        if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
            if($('input[name=\'agree\']').is(':checked')){
            }else{
                flag = false;
                error = '{{ agree_error }}';
            }
        }
        var value = $("input:radio[name=account]:checked").val();
        var loggedIn="{{ logged }}";
        if(loggedIn == '' && value=='register_manual'){
            if($('input[name=\'privacy\']').is(':checked')){
            }else{
                flag = false;
                error = '{{ privacy_error }}';
            }
        }
        if(flag){
            $('#confirm_order').attr('disabled', true);
            var btn = $(this);
            btn.prop('disabled', true);
            setTimeout(function(){
                btn.prop('disabled', false);
            }, 5000);
            if(window.confirmclick==true){
                window.callconfirm=true;
            }else{
                validateCheckout();
            }
        }else{
            $('#payment_display_block .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + error + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
            $('#payment_display_block .supercheckout-checkout-content').show();
            $('.warning').fadeIn('slow');
            goToByScroll('payment_display_block');
        }
    });

    /*** ON CHANGING PAYMENT METHOD */
    $("body").on('click', "input[name='payment_method']", function() {
   // $("input[name='payment_method']").on('change',function(){
        $('#confirmLoader').show();
        $.ajax({
            url: 'index.php?route=supercheckout/payment_method/validate',
            type: 'post',
            data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea'),
            dataType: 'json',
            beforeSend: function() {
                $('#button-payment-method').attr('disabled', true);
                $('#button-payment-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-payment-method').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {
                $('#confirmLoader').hide();
                $('.warning, .error').remove();

                if (json['redirect']) {
                    location = json['redirect'];
                } else if (json['error']) {
                    if (json['error']['warning']) {
                        alert(json['error']['warning']);
                        $('#payment-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/delete.png" alt="" class="close" /></div>');
                        $('.warning').fadeIn('slow');
                    }
                } else {
                
                    $('#confirmLoader').show();
                    $.ajax({
                        url: 'index.php?route=supercheckout/confirm',
                        dataType: 'html',
                        success: function(html) {
                            $('#confirmLoader').hide();
                            $('#confirmCheckout').html(html);
                            $('#paymentDisable').html("");
                            $.ajax({
                                url: 'index.php?route=supercheckout/payment_display',
                                dataType: 'html',
                                success: function(html) {
                                    $('#display_payment').html(html);
                                    $("{{ hidden_classes_trigger }}").hide();
                                    //validatePaymentMethodRefresh();
                                },
                                error: function(xhr, ajaxOptions, thrownError) {
                                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                                }
                            });
                        },
                        error: function(xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
                }
            },
            error: function(xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

    // ON CHANGING SHIPPING  METHOD
    $("body").on('click', "input[name='shipping_method']", function() {
//        alert('asdad');
        $('#confirmLoader').show();
        $.ajax({
            url: 'index.php?route=supercheckout/shipping_method/validate',
            type: 'post',
            data: $('#shipping-method input[type=\'radio\']:checked'),
            dataType: 'json',
            beforeSend: function() {
                $('#button-shipping-method').attr('disabled', true);
                $('#button-shipping-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-shipping-method').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {
                $('#confirmLoader').hide();
                $('.warning, .error').remove();

                if (json['redirect']) {
                    //location = json['redirect'];
                } else if (json['error']) {
                    if (json['error']['warning']) {
                        $('#shipping-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                        $('.warning').fadeIn('slow');
                    }
                } else {
                    $('#paymentMethodLoader').show();
                    $.ajax({
                        url: 'index.php?route=supercheckout/payment_method',
                        dataType: 'html',
                        success: function(html) {
//                            console.log(html);
                            $('#payment-method').html(html);
                            $('#paymentMethodLoader').hide();
            
                            $('#confirmLoader').show();
                            $.ajax({
                                url: 'index.php?route=supercheckout/confirm',
                                dataType: 'html',
                                success: function(html) {
                                    //updatecartinheader();           
                                    $('#confirmLoader').hide();
                                    $('#confirmCheckout').html(html);
                                    $('#paymentDisable').html("");
                                    $.ajax({
                                        url: 'index.php?route=supercheckout/payment_display',
                                        dataType: 'html',
                                        success: function(html) {
                                            $('#display_payment').html(html);
                                            $("{{ hidden_classes_trigger }}").hide();
                                            //validatePaymentMethodRefresh();
                                        },
                                        error: function(xhr, ajaxOptions, thrownError) {
                                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                                        }
                                    });
                                },
                                error: function(xhr, ajaxOptions, thrownError) {
                                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                                }
                            });
                        }
                    });
                }
            },
            error: function(xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });
    
  
    // ON CONFIRM CLICK VALIDATING THE WHOLE PAGE AT ONCE AND DISPLAYS ERROR ACCORDINGLY
    function goToByScroll(id){
        // Remove "link" from the ID
        id = id.replace("link", "");
        // Scroll
        $('html,body').animate({scrollTop: $("#"+id).offset().top}, 'slow');
    }

function validatePaymentAddress(){

    var paymentAddressEnable="1";

    if(paymentAddressEnable==1){
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/loginPaymentAddressValidate',
            type: 'post',
            data: $('#checkoutBillingAddress input[type=\'text\'], #checkoutBillingAddress input[type=\'password\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #checkoutBillingAddress input[type=\'radio\']:checked, #checkoutBillingAddress input[type=\'hidden\'], #checkoutBillingAddress select'),
            dataType: 'json',
            beforeSend: function() {
                $('#button-payment-address').attr('disabled', true);
                $('#button-payment-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-payment-address').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {
                $('.warning, .errorsmall').remove();

                if (json['redirect']) {
                    location = json['redirect'];
                } else if (json['error']) {
                    enableForm();
                    goToByScroll('checkoutBillingAddress');
                    if (json['error']['warning']) {
                        $('#checkoutBillingAddress .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                        $('#checkoutBillingAddress .supercheckout-checkout-content').show();
                        $('.warning').fadeIn('slow');
                    }

                    if (json['error']['firstname']) {
                        $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                    }

                    if (json['error']['custom_field']) {
                        for( x in json['error']['custom_field'] ){
                            $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                        }
                    }
                    
                    if (json['error']['lastname']) {
                        $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                    }

                    if (json['error']['telephone']) {
                        $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                    }
                    if (json['error']['company']) {
                        $('#payment-new input[name=\'company\']').after('<span class="errorsmall">' + json['error']['company'] + '</span>');
                    }
                    if (json['error']['address_1']) {
                        $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                    }
                    if (json['error']['address_2']) {
                        $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                    }

                    if (json['error']['city']) {
                        $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                    }

                    if (json['error']['postcode']) {
                        $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                    }

                    if (json['error']['country']) {
                        $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                    }

                    if (json['error']['zone']) {
                        $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                    }
                } else {
{#                    $("#progressbar" ).progressbar({ value:35 });#}
                        progressbar(35);
                    validateLoginShippingAddress();
                }
            }
        });
    }
    else{
{#        $("#progressbar" ).progressbar({ value:35 });#}
             progressbar(35);
        validateLoginShippingAddress();
    }
}
function progressbar(value){
    $('#progressbar').html('<div class="ui-progressbar-value ui-corner-left ui-widget-header" style="width: '+ value +'%;"></div>')
}
function validateLoginShippingAddress(){
    var paymentAddressEnable="1";
    var shippingMethodEnable="{{ settings['step']['shipping_method']['display_options'] }}";
    var paymentMethodEnable="{{ settings['step']['payment_method']['display_options'] }}";
    if(paymentAddressEnable==1){
        if(!$('#shipping_use').is(":checked")){
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/loginShippingAddressValidate',
                type: 'post',
                data: $('#checkoutShippingAddress input[type=\'text\'], #checkoutShippingAddress input[type=\'password\'], #checkoutShippingAddress input[type=\'checkbox\']:checked, #checkoutShippingAddress input[type=\'radio\']:checked, #checkoutShippingAddress select'),
                dataType: 'json',
                beforeSend: function() {
                    $('#button-shipping-address').attr('disabled', true);
                    $('#button-shipping-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
                },
                complete: function() {
                    $('#button-shipping-address').attr('disabled', false);
                    $('.wait').remove();
                },
                success: function(json) {
                    $('.warning, .error').remove();

                    if (json['redirect']) {
                        location = json['redirect'];
                    } else if (json['error']) {
                        enableForm();
                        if (json['error']['warning']) {
                            $('#checkoutShippingAddress .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                            $('#checkoutShippingAddress .supercheckout-checkout-content').show();
                            $('.warning').fadeIn('slow');
                        }
                        goToByScroll('checkoutShippingAddress');
                        if (json['error']['firstname']) {
                            $('#shipping-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                        }

                        if (json['error']['custom_field']) {
                            for( x in json['error']['custom_field'] ){
                                $('#shipping-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                            }
                        }
                        
                        if (json['error']['lastname']) {
                            $('#shipping-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                        }

                        if (json['error']['email']) {
                            $('#shipping-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                        }

                        if (json['error']['telephone']) {
                            $('#shipping-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                        }

                        if (json['error']['address_1']) {
                            $('#shipping-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                        }
                        if (json['error']['address_2']) {
                            $('#shipping-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                        }
                        if (json['error']['city']) {
                            $('#shipping-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                        }

                        if (json['error']['postcode']) {
                            $('#shipping-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                        }

                        if (json['error']['country']) {
                            $('#shipping-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                        }

                        if (json['error']['zone']) {
                            $('#shipping-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                        }
                    } else {
{#                        $("#progressbar" ).progressbar({ value:50 });#}
                          progressbar(50);
                        if(shippingMethodEnable==1){
                            validateShippingMethod();
                        }else{
                            if(paymentMethodEnable==1){
                                validatePaymentMethod();
                            }else{
                                var agreeRequire="{{ agree_require }}";
                                if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                                    validateAgree();
                                }
                                else{
                                    goToConfirm();
                                }
                            }
                        }
                    }
                }
            });
        }else{
            if(shippingMethodEnable==1){
                validateShippingMethod();
            }else{
                if(paymentMethodEnable==1){
                    validatePaymentMethod();
                }else{
                    var agreeRequire="{{ agree_require }}";
                    if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                        validateAgree();
                    }
                    else{
                        goToConfirm();
                    }
                }
            }
        }
    }
    else{
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/loginShippingAddressValidate',
            type: 'post',
            data: $('#checkoutShippingAddress input[type=\'text\'], #checkoutShippingAddress input[type=\'password\'], #checkoutShippingAddress input[type=\'radio\']:checked, #checkoutShippingAddress select'),
            dataType: 'json',
            beforeSend: function() {
                $('#button-shipping-address').attr('disabled', true);
                $('#button-shipping-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-shipping-address').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {
                $('.warning, .error').remove();

                if (json['redirect']) {
                    location = json['redirect'];
                } else if (json['error']) {
                    enableForm();
                    if (json['error']['warning']) {
                        $('#checkoutShippingAddress .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                        $('#checkoutShippingAddress .supercheckout-checkout-content').show();
                        $('.warning').fadeIn('slow');
                    }

                    if (json['error']['firstname']) {
                        $('#shipping-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                    }
                    
                    if (json['error']['custom_field']) {
                        for( x in json['error']['custom_field'] ){
                            $('#shipping-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                        }
                    }
                    
                    if (json['error']['lastname']) {
                        $('#shipping-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                    }

                    if (json['error']['email']) {
                        $('#shipping-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                    }

                    if (json['error']['telephone']) {
                        $('#shipping-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                    }

                    if (json['error']['address_1']) {
                        $('#shipping-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                    }
                    if (json['error']['address_2']) {
                        $('#shipping-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                    }
                    if (json['error']['city']) {
                        $('#shipping-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                    }

                    if (json['error']['postcode']) {
                        $('#shipping-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                    }

                    if (json['error']['country']) {
                        $('#shipping-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                    }

                    if (json['error']['zone']) {
                        $('#shipping-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                    }
                } else {
{#                    $("#progressbar" ).progressbar({ value:50 });#}
                          progressbar(50);
                    if(shippingMethodEnable==1){
                        validateShippingMethod();
                    }else{
                        if(paymentMethodEnable==1){
                            validatePaymentMethod();
                        }else{
                            var agreeRequire="{{ agree_require }}";
                                if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                                validateAgree();
                            }
                            else{
                                goToConfirm();
                            }
                        }
                    }
                }
            }
        });
    }
}
function validateShippingMethod(){
    var paymentMethodEnable="{{ settings['step']['payment_method']['display_options'] }}";
    $.ajax({
        url: 'index.php?route=supercheckout/shipping_method/validate',
        type: 'post',
        data: $('#shipping-method input[type=\'radio\']:checked'),
        dataType: 'json',
        beforeSend: function() {
            $('#button-shipping-method').attr('disabled', true);
            $('#button-shipping-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('#button-shipping-method').attr('disabled', false);
            $('.wait').remove();
        },
        success: function(json) {
            $('.warning, .error').remove();

            if (json['redirect']) {
            //				location = json['redirect'];
            } else if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#shipping-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#shipping-method .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                }
            } else {
{#                $("#progressbar" ).progressbar({ value:65 });#}
                  progressbar(65);
                if(paymentMethodEnable==1){
                    validatePaymentMethod();
                }else{
                    var agreeRequire="{{ agree_require }}";
                    if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                        validateAgree();
                    }
                    else{
                        goToConfirm();
                    }
                }
            }
        }
    });
}
function validatePaymentMethod(){
    $.ajax({
        url: 'index.php?route=supercheckout/payment_method/validate',
        type: 'post',
        data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea,#payment_display_block input[type=\'checkbox\']'),
        dataType: 'json',
        beforeSend: function() {
            $('#button-payment-method').attr('disabled', true);
            $('#button-payment-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('#button-payment-method').attr('disabled', false);
            $('.wait').remove();
        },
        success: function(json) {
            $('.warning, .error').remove();

            if (json['redirect']) {
                location = json['redirect'];
            } else if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#payment-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#payment-method .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                }else if(json['error']['warnings']){
                    $('#payment_display_block .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warnings'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#payment_display_block .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('payment_display_block');
                }
            } else {
{#                $("#progressbar" ).progressbar({ value:80 });#}
                progressbar(80);
                var agreeRequire="{{ agree_require }}";
                var comment="{{ comment_check }}";
                if(comment=='loginblock' || comment=='guestblock'){
                    setComment();
                }
                if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                    validateAgree();

                }
                else{
                    goToConfirm();
                }
            }
        }
    });
}
function setComment(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/setCommentSession',
        type: 'post',
        data: $('#supercheckout-comment_order'),
        dataType: 'json',
        success: function(json) {

        }
    });
}
function validateAgree(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/validateAgree',
        type: 'post',
        data: $('#payment_display_block input[type=\'checkbox\']:checked'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();

            if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#payment_display_block .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#payment_display_block .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('payment_display_block');
                }
            } else {
                goToConfirm();
            }
        }
    });

}
function createGuestAccount(){
    
     if ( $('#newsletter').is(':checked'))
    {
    $("#newsletter").attr("value","1"); //to set value 1 if user check newsletter checkbox
    
    }
   else{
       $("#newsletter").attr("value","0");
   
        }
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/createGuestAccount',
        type:'post',
        data: $('#checkoutLogin input[type=\'text\'], #checkoutLogin select, #customer_group_div input[type=\'radio\']:checked, #supercheckout-login-register-manual input[type=\'hidden\'],#newsletter'),
        success: function(html) {            
{#            $("#progressbar" ).progressbar({ value:60 });#}
            progressbar(60);
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
}
function goToConfirm(){
        setComment();
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/mailchimp',
            dataType: 'json',
            type:'post',
            data: {
                'newsletter' : '1',
            },
            success: function(json) {
                
            }
        });
        $.ajax({
        url: 'index.php?route=supercheckout/confirm',
        dataType: 'html',
        success: function(html) {
//            addToMailchimp();
{#            $("#progressbar" ).progressbar({ value:100 });#}
            progressbar(100);
            var href = $("{{ hidden_classes }} ").attr('href');
            if(href != '' && href != undefined && href != 'javascript://' && href != 'javascript:void(0)') {
                document.location.href = href;
                console.log('clicked');	
            }else{
		enableForm();
                $("{{ hidden_classes_trigger }}").not('#button-delete').trigger("click", function(){	
                console.log('clicked');	
            })
            }
//            $("#button-confirm , input[type=submit] , .display_payment .button, #display_payment .button").trigger("click");
        //            $("#button-confirm , input[type=submit]").unbind("click");
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });

}
function validateEmail(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/validateEmail',
        type: 'post',
        data: $('#checkoutLogin input[type=\'text\']'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();
            if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin');
                }
            }
            else {
{#                $("#progressbar" ).progressbar({ value: 20 });#}
                progressbar(20);
                validateGuestPaymentAddress();
            }

        }
    });
}
function validateEmailAndPassword(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/validateEmailAndPassword',
        type: 'post',
        data: $('#checkoutLogin input[type=\'text\'],#checkoutLogin input[type=\'password\']'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();
            if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin');
                }
                if(json['error']['mismatch']){ 
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['mismatch'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin');
                }
                if(json['error']['password']){ 
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['password'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin');
                }
            }else {
{#                $("#progressbar" ).progressbar({ value: 20 });#}
                progressbar(20);
                validateGuestPaymentAddress();
            }

        }
    });
}
function matchPassword(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/validateEmailAndPassword',
        type: 'post',
        data: $('#checkoutLogin input[type=\'text\'],#checkoutLogin input[type=\'password\']'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();
            if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin ');
                }
                if(json['error']['mismatch']){ 
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['mismatch'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin ');
                }
                if(json['error']['password']){ 
                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['password'] + '</div>');
                    $('#checkoutLogin .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('checkoutLogin ');
                }
            }
        }
    });
}
function validateGuestPaymentAddress(){
    var paymentGuestAddressEnable="1";
    var useforShippingEnable="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}";
    if(paymentGuestAddressEnable==1){
        if(useforShippingEnable==1){
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/guestPaymentAddressValidate',
                type: 'post',
                data: $('#payment-new  input[type=\'text\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #payment-new select, #checkoutLogin input[name=\'email\'] '),
                dataType: 'json',
                beforeSend: function() {
                    $('#button-guest').attr('disabled', true);
                    $('#button-guest').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
                },
                complete: function() {
                    $('#button-guest').attr('disabled', false);
                    $('.wait').remove();
                },
                success: function(json) {
                    $('.warning, .errorsmall').remove();

                    if (json['redirect']) {
                        location = json['redirect'];
                    }
                    else if (json['error']) {
                        enableForm();
                        if (json['error']['warning']) {
                            $('#payment-new .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');

                            $('.warning').fadeIn('slow');
                        }

                        if (json['error']['firstname']) {
                            $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                        }
                        
                        if (json['error']['custom_field']) {
                            for( x in json['error']['custom_field'] ){
                                $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                            }
                        }
                        
                        if (json['error']['lastname']) {
                            $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                        }

                        if (json['error']['email']) {
                            $('#payment-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                        }

                        if (json['error']['telephone']) {
                            $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                        }
                        if (json['error']['company']) {
                            $('#payment-new input[name=\'company\']').after('<span class="errorsmall">' + json['error']['company'] + '</span>');
                        }
                        if (json['error']['address_1']) {
                            $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                        }
                        if (json['error']['address_2']) {
                            $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                        }
                        if (json['error']['city']) {
                            $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                        }

                        if (json['error']['postcode']) {
                            $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                        }

                        if (json['error']['country']) {
                            $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                        }

                        if (json['error']['zone']) {
                            $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                        }
                        goToByScroll('checkoutBillingAddress');
                    }
                    else {
{#                        $("#progressbar" ).progressbar({ value: 35 });#}
                        progressbar(35);
                        checkGuestShippingAddress();
                    }
                }
            });
        }
        else{
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/guestPaymentAddressValidate',
                type: 'post',
                data: $('#payment-new  input[type=\'text\'],  #payment-new select , #checkoutLogin input[name=\'email\']'),
                dataType: 'json',
                beforeSend: function() {
                    $('#button-guest').attr('disabled', true);
                    $('#button-guest').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
                },
                complete: function() {
                    $('#button-guest').attr('disabled', false);
                    $('.wait').remove();
                },
                success: function(json) {
                    $('.warning, .errorsmall').remove();

                    if (json['redirect']) {
                        location = json['redirect'];
                    }
                    else if (json['error']) {
                        enableForm();
                        if (json['error']['warning']) {
                            $('#payment-new .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');

                            $('.warning').fadeIn('slow');
                        }

                        if (json['error']['firstname']) {
                            $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                        }
                        
                        if (json['error']['custom_field']) {
                            for( x in json['error']['custom_field'] ){
                                $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                            }
                        }
                        
                        if (json['error']['lastname']) {
                            $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                        }

                        if (json['error']['email']) {
                            $('#payment-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                        }

                        if (json['error']['telephone']) {
                            $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                        }
                        if (json['error']['address_1']) {
                            $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                        }
                        if (json['error']['address_2']) {
                            $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                        }
                        if (json['error']['city']) {
                            $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                        }

                        if (json['error']['postcode']) {
                            $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                        }

                        if (json['error']['country']) {
                            $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                        }

                        if (json['error']['zone']) {
                            $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                        }
                        goToByScroll('checkoutBillingAddress');
                    }
                    else {
{#                        $("#progressbar" ).progressbar({ value: 35 });#}
                        progressbar(35);
                        checkGuestShippingAddress();
                    }
                }
            });
        }
    }else{

        validateGuestShippingAddress();
    }
}
function validateGuestShippingAddress(){
    var paymentMethodEnable="{{ settings['step']['payment_method']['display_options'] }}";
    var shippingMethodEnable="{{ settings['step']['shipping_method']['display_options'] }}";
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/guestShippingAddressValidate',
        type: 'post',
        data: $('#shipping-new input[type=\'text\'], #shipping-new select'),
        dataType: 'json',
        beforeSend: function() {
            $('#button-guest-shipping').attr('disabled', true);
            $('#button-guest-shipping').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('#button-guest-shipping').attr('disabled', false);
            $('.wait').remove();
        },
        success: function(json) {
            $('.warning, .errorsmall').remove();

            if (json['redirect']) {
                location = json['redirect'];
            } else if (json['error']) {
                enableForm();
                if (json['error']['warning']) {
                    $('#shipping-new .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');

                    $('.warning').fadeIn('slow');
                }

                if (json['error']['firstname']) {
                    $('#shipping-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                }
                
                if (json['error']['custom_field']) {
                    for( x in json['error']['custom_field'] ){
                        $('#shipping-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                    }
                }
                
                if (json['error']['lastname']) {
                    $('#shipping-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                }

                if (json['error']['address_1']) {
                    $('#shipping-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                }
                if (json['error']['address_2']) {
                    $('#shipping-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                }
                if (json['error']['city']) {
                    $('#shipping-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                }

                if (json['error']['postcode']) {
                    $('#shipping-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                }

                if (json['error']['country']) {
                    $('#shipping-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                }

                if (json['error']['zone']) {
                    $('#shipping-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                }
                goToByScroll('checkoutShippingAddress');
            } else {
{#                $("#progressbar" ).progressbar({ value:50 });#}
                progressbar(50);
                var checkGuestRegisterEnable="{{ settings['general']['guestenable'] }}";
                var checkRegisterManualEnable="{{ settings['general']['guest_manual'] }}";
                var use_password_string = "";
                var loginRadioCheck=$("input:radio[name=account]:checked").val();
                if(checkRegisterManualEnable==1 && loginRadioCheck=="register_manual"){
                    use_password_string = '&use_password=1';
                }
    /////////////////////////////////////////////////////////////////////////////////////////
                if(checkGuestRegisterEnable==0 && loginRadioCheck=="guest"){
                    use_password_string = '&use_password=0';
                } //first out of two loops to fix always registering guest with password
    /////////////////////////////////////////////////////////////////////////////////////////
                if(checkGuestRegisterEnable==1 || checkRegisterManualEnable==1){
                  if ( $('#newsletter').is(':checked'))
                  $("#newsletter").attr("value","1");
                 else{
                  $("#newsletter").attr("value","0");
                   }
    
                         $.ajax({
                        url: 'index.php?route=supercheckout/supercheckout/createGuestAccount'+use_password_string,
                        type:'post',
                        dataType:'json',
                        data: $('#checkoutLogin input[type=\'text\'], #checkoutLogin select, #customer_group_div input[type=\'radio\']:checked, #checkoutLogin input[name=\'password_register\'], #newsletter , #supercheckout-login-register-manual input[type=\'hidden\']'),
                        success: function(json) {   
                            if (json['error']) {
                                enableForm();
                                if (json['error']['warning']) {
                                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                                    $('#checkoutLogin .supercheckout-checkout-content').show();
                                    $('.warning').fadeIn('slow');
                                    goToByScroll('checkoutLogin');
                                }
                            }else{
{#                                $("#progressbar" ).progressbar({ value:60 });#}
                                progressbar(60);
                                if(shippingMethodEnable==1){
                                    validateShippingMethod();
                                }else{
                                    if(paymentMethodEnable==1){
                                        validatePaymentMethod();
                                    }else{
                                        var agreeRequire="{{ agree_require }}";
                                        if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                                            validateAgree();
                                        }
                                        else{
                                            goToConfirm();
                                        }
                                    }
                                }
                            }
                        },
                        error: function(xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
                }else{
                    if(shippingMethodEnable==1){
                        validateShippingMethod();
                    }else{
                        if(paymentMethodEnable==1){
                            validatePaymentMethod();
                        }else{
                            var agreeRequire="{{ agree_require }}";
                            if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                                validateAgree();
                            }
                            else{
                                goToConfirm();
                            }
                        }
                    }
                }
                
            }
        }
    });
}
function checkGuestShippingAddress(){
    var ShippingUseEnable="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}"
    var paymentGuestAddressEnable="1";
    var paymentMethodEnable="{{ settings['step']['payment_method']['display_options'] }}";
    var shippingMethodEnable="{{ settings['step']['shipping_method']['display_options'] }}";
    if(ShippingUseEnable==1)
    {
        if($('#shipping_use').is(":checked")){
            var checkGuestRegisterEnable="{{ settings['general']['guestenable'] }}";
            var checkRegisterManualEnable="{{ settings['general']['guest_manual'] }}";
                var use_password_string = "";
                var loginRadioCheck=$("input:radio[name=account]:checked").val();
                if(checkRegisterManualEnable==1 && loginRadioCheck=="register_manual"){
                    use_password_string = '&use_password=1';
                }
   /////////////////////////////////////////////////////////////////////////////////////////
                if(checkGuestRegisterEnable==0 && loginRadioCheck=="guest"){
                    use_password_string = '&use_password=0';
                } // second out of two loops to fix always registering guest with password
     /////////////////////////////////////////////////////////////////////////////////////////
                if(checkGuestRegisterEnable==1 || checkRegisterManualEnable==1){
                    if ( $('#newsletter').is(':checked'))
                    $("#newsletter").attr("value","1");
                   else{
                       $("#newsletter").attr("value","0");
                   } $.ajax({
                        url: 'index.php?route=supercheckout/supercheckout/createGuestAccount'+use_password_string,
                        type:'post',
                        dataType:'json',
                        data: $('#checkoutLogin input[type=\'text\'], #checkoutLogin select, #customer_group_div input[type=\'radio\']:checked, #checkoutLogin input[type=\'hidden\'],#checkoutLogin input[name=\'password_register\'], #newsletter'),
                        success: function(json) {   
                            if (json['error']) {
                                enableForm();
                                if (json['error']['warning']) {
                                    $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                                    $('#checkoutLogin .supercheckout-checkout-content').show();
                                    $('.warning').fadeIn('slow');
                                    goToByScroll('checkoutLogin');
                                }
                            }else{
{#                                $("#progressbar" ).progressbar({ value:60 });#}
                                progressbar(60);
                                if(shippingMethodEnable==1){
                                    validateShippingMethod();
                                }else{
                                    if(paymentMethodEnable==1){
                                        validatePaymentMethod();
                                    }else{
                                        var agreeRequire="{{ agree_require }}";
                                        if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                                            validateAgree();
                                        }
                                        else{
                                            goToConfirm();
                                        }
                                    }
                                }
                            }
                        },
                        error: function(xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
            }else{
                if(shippingMethodEnable==1){
                    validateShippingMethod();
                }else{
                    if(paymentMethodEnable==1){
                        validatePaymentMethod();
                    }else{
                        var agreeRequire="{{ agree_require }}";
                        if(agreeRequire=='loginblock' || agreeRequire=='guestblock'){
                            validateAgree();
                        }
                        else{
                            goToConfirm();
                        }
                    }
                }
            }
            
        }
        else{
            validateGuestShippingAddress();
        }
    }else{
        validateGuestShippingAddress()
    }

}

function validateCheckout(){
    disableForm();
    var loginRadio=$("input:radio[name=account]:checked").val();
    var guestEnable="{{ settings['step']['login']['option']['guest']['display'] }}";
    var loggedIn="{{ logged }}";//271
    if(guestEnable==0)
    {
	
	if(loginRadio=='register_manual'){
	    validateEmailAndPassword();
	}
        else if(loginRadio=='register') { 
	    if(loggedIn==''){
                $('#checkoutLogin .supercheckout-checkout-content').html('<div class="warning" style="display: none;">' + '{{ please_login_error }}' + '</div>');
                $('#checkoutLogin .supercheckout-checkout-content').show();
                $('.warning').fadeIn('slow');
                enableForm();
                goToByScroll('checkoutLogin');
            }
        } else {
            validatePaymentAddress();
        }
    } else {
        var loginRadio=$("input:radio[name=account]:checked").val();
        if(loginRadio=="register") {
            if(loggedIn=='') {
                $('#checkoutLogin .supercheckout-checkout-content').html('<div class="warning" style="display: none;">' + '{{ please_login_error }}' + '</div>');
                $('#checkoutLogin .supercheckout-checkout-content').show();
                $('.warning').fadeIn('slow');
                goToByScroll('checkoutLogin');
                enableForm();
            }
        }
        else if(loginRadio == "guest") {
            validateEmail();
        }else if(loginRadio == "register_manual"){
            validateEmailAndPassword();
        }
        if(loggedIn) {
            validatePaymentAddress();
        }
//        var loginRadio=$("input:radio[name=account]:checked").val();
//        if(loginRadio=="register") {
//            validateEmailAndPassword();
//        }
//        else if(loginRadio == "guest") {
//            validateEmail();
//        }
//        if(loggedIn) {
//            validatePaymentAddress();
//        }
    }
//    if(loginEnable==0 && guestEnable==0)
//    {
//
//        if(loggedIn==''){
//            $('#checkoutLogin .supercheckout-checkout-content').html('<div class="warning" style="display: none;">' + '{{ please_login_error }}' + '</div>');
//            $('#checkoutLogin .supercheckout-checkout-content').show();
//            $('.warning').fadeIn('slow');
//            $('html, body').animate({
//                scrollTop: 0
//            }, 'slow');
//        }else{
//            validatePaymentAddress();
//        }
//    }
}
//FOR REFRESSHING STEPS TO GET ORDER DETAILS
function validatePaymentAddressRefresh(){

    var paymentAddressEnable="1";
    if(paymentAddressEnable==1){
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/setValueForLoginPayment',
            type: 'post',
            dataType:'json',
            data: $('#checkoutBillingAddress input[type=\'text\'], #checkoutBillingAddress input[type=\'password\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #checkoutBillingAddress input[type=\'radio\']:checked, #checkoutBillingAddress input[type=\'hidden\'], #checkoutBillingAddress select, #checkoutBillingAddress input[type=\'checkbox\']:checked'),
            success: function(json) {
                    validateLoginShippingAddressRefresh();
            }
        });
    }
    else{
        validateLoginShippingAddressRefresh();
    }
}
function validateLoginShippingAddressRefresh() {
    var paymentAddressEnable="1";
    if(paymentAddressEnable==1){
        if(!$('#shipping_use').is(":checked")){
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/setValueForLoginShipping',
                type: 'post',
                data: $('#checkoutShippingAddress input[type=\'text\'], #checkoutShippingAddress input[type=\'password\'], #checkoutShippingAddress input[type=\'checkbox\']:checked, #checkoutShippingAddress input[type=\'radio\']:checked, #checkoutShippingAddress select'),
                success: function(json) {
                    $('.warning, .error').remove();
                    

                    {
                        refreshAll();
                    }
                }
            });
        } else {
            refreshAll();
        }
    }
    else{
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/setValueForLoginShipping',
            type: 'post',
            data: $('#checkoutShippingAddress input[type=\'text\'], #checkoutShippingAddress input[type=\'password\'], #checkoutShippingAddress input[type=\'radio\']:checked, #checkoutShippingAddress select'),
            success: function(json) {
                refreshAll();
            }
        });
    }
}
function validateShippingMethodRefresh(){
    $.ajax({
        url: 'index.php?route=supercheckout/shipping_method/validate',
        type: 'post',
        data: $('#shipping-method input[type=\'radio\']:checked'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();

            if (json['redirect']) {
            } else if (json['error']) {
                if (json['error']['warning']) {
                    $('#shipping-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#shipping-method .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                }
            } else {
                validatePaymentMethodRefresh();
            }
        }
    });
}

function validatePaymentMethodRefresh(){
    $.ajax({
        url: 'index.php?route=supercheckout/payment_method/validate',
        type: 'post',
        data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea,#payment_display_block input[type=\'checkbox\']'),
        dataType: 'json',
        success: function(json) {
            $('.warning, .error').remove();

            if (json['redirect']) {
                location = json['redirect'];
            } else if (json['error']) {
                if (json['error']['warning']) {
                    $('#payment-method .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#payment-method .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                } else if(json['error']['warnings']) {
                    $('#payment_display_block .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warnings'] + '<img src="catalog/view/theme/{{ default_theme }}/image/close.png" alt="" class="close" /></div>');
                    $('#payment_display_block .supercheckout-checkout-content').show();
                    $('.warning').fadeIn('slow');
                    goToByScroll('payment_display_block');
                }
            } else {
                goToConfirmRefresh();
            }
        }
    });
}

function goToConfirmRefresh(){
    $.ajax({
        url: 'index.php?route=supercheckout/confirm',
        dataType: 'html',
        success: function(html) {
            $('#confirmLoader').hide();
            $('#confirmCheckout').html(html);
            $('#paymentDisable').html("");
            $.ajax({
                url: 'index.php?route=supercheckout/payment_display',
                dataType: 'html',
                success: function(html) {
                    $('#display_payment').html(html);
                    $("{{ hidden_classes_trigger }}").hide();
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
            if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
            }
            window.callconfirm=false;
            window.confirmclick=false;
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });

}
function validateGuestPaymentAddressRefresh(){
    var paymentGuestAddressEnable="1";
    var useforShippingEnable="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}";
    //alert(useforShippingEnable);
    if(paymentGuestAddressEnable==1){
        if(useforShippingEnable==1){
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/setValueForGuestPayment',
                type: 'post',
                data: $('#payment-new  input[type=\'text\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #payment-new select, #checkoutLogin input[name=\'email\'] '),
                success: function(json) {
                    $('.warning, .errorsmall').remove();

                    {
                        checkGuestShippingAddressRefresh();
                        
                    }
                }
            });
        }
        else{
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/setValueForGuestPayment',
                type: 'post',
                data: $('#payment-new  input[type=\'text\'],  #payment-new select'),
                success: function(json) {
                {
                    checkGuestShippingAddressRefresh();
                }
                }
            });
        }
    }else{

        validateGuestShippingAddressRefresh();
    }
}
function validateGuestShippingAddressRefresh(){
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/setValueForGuestShipping',
        type: 'post',
        data: $('#shipping-new input[type=\'text\'], #shipping-new select'),
        success: function() {
            $('.warning, .errorsmall').remove();
            refreshAll();

        }
    });
}
function checkGuestShippingAddressRefresh(){
    var ShippingUseEnable="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}"
    var paymentGuestAddressEnable="1";
//alert(ShippingUseEnable);
    if(ShippingUseEnable==1)
    {
        if($('#shipping_use').is(":checked")){
        

            refreshAll();
        }
        else{
	    
            validateGuestShippingAddressRefresh();
        }
    }else{
        validateGuestShippingAddressRefresh()
    }

}


function validateCheckoutRefresh(){
    var guestEnable="{{ settings['step']['login']['option']['guest']['display'] }}";
    var loggedIn="{{ logged }}";//271
    if(guestEnable==0)
    {
        validatePaymentAddressRefresh();
    }
//    if(loginEnable==0 && guestEnable==1)
//    {
//        validateGuestPaymentAddressRefresh();
//    }
    else
    {
        if(loggedIn!=""){
            validatePaymentAddressRefresh();
        }else{
            validateGuestPaymentAddressRefresh();
        }
    }
//    if(loginEnable==0 && guestEnable==0)
//    {
//            validatePaymentAddressRefresh();
//    }
}

</script>
<script type="text/javascript">
    $('#checkoutShippingAddress input[name=\'shipping_address\']').on('change', function() {
        if (this.value == 'new') {
            $('#shipping-existing').hide();
            $('#shipping-new').show();
            validateCheckoutRefresh();
        } else {
            $('#shipping-existing').show();
            $('#shipping-new').hide();
            validateCheckoutRefresh();
        }
    });
</script>
<script type="text/javascript">
// GENERAL SETTING FOR HIDING DISPLAYING NEW & EXISTING SHIPPING ADDRESS
$('#shipping-existing select[name=\'address_id\']').bind('change', function() {
        validateCheckoutRefresh();
    });
    $('#payment-existing select[name=\'address_id\']').bind('change', function() {
        validateCheckoutRefresh();
    });
    $('#shipping-new select[name=\'country_id\']').bind('change', function() {
        if (this.value == '') return;

        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/country&country_id=' + this.value,
            dataType: 'json',
            beforeSend: function() {
                $('#shipping-new select[name=\'country_id\']').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('.wait').remove();
            },
            success: function(json) {
                if (json['postcode_required'] == '1') {                
                    $('#shipping-postcode-required').show();
                } else {                
                    $('#shipping-postcode-required').hide();
                }

                html = '<option value="">{{ text_select }}</option>';

                if (json['zone'] != '') {
                    for (i = 0; i < json['zone'].length; i++) {
                        html += '<option value="' + json['zone'][i]['zone_id'] + '"';

                        if (json['zone'][i]['zone_id'] == '{{ zone_id }}') {
                            html += ' selected="selected"';
                        }

                        html += '>' + json['zone'][i]['name'] + '</option>';
                    }
                } else {
                    html += '<option value="0" selected="selected">{{ text_none }}</option>';
                }

                $('#shipping-new select[name=\'zone_id\']').html(html);
                validateCheckoutRefresh();


            },
            error: function(xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

$('#shipping-new select[name=\'zone_id\']').bind('change', function() {
    if (this.value == '') return;
    
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/city&zone_id=' + this.value,
        dataType: 'json',
        beforeSend: function() {
            $('#shipping-new select[name=\'zone_id\']').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('.wait').remove();
        },
        success: function(json) {
            html = '<option value="">{{ text_select }}</option>';
            
            if (json != '') {
                for (i = 0; i < json.length; i++) {
                    html += '<option value="' + json[i]['name'] + '"';
                    
                    if (json[i]['name'] == '{{ city }}') {
                        html += ' selected="selected"';
                    }
                    
                    html += '>' + json[i]['name'] + '</option>';
                }
            } else {
                html += '<option value="0" selected="selected">{{ text_none }}</option>';
            }
            
            $('#shipping-new select[name=\'city\']').html(html);
            validateCheckoutRefresh();
            
            
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
});

$('#shipping-new select[name=\'city\']').bind('change', function() {
    validateCheckoutRefresh();
});

</script>
<script type="text/javascript">
    
// GENERAL SETTING FOR HIDING DISPLAYING NEW & EXISTING BILLING ADDRESS
$('#checkoutBillingAddress input[name=\'payment_address\']').on('change', function() {
    if (this.value == 'new') {
        $('#payment-existing').hide();
        $('#payment-new').show();
        validateCheckoutRefresh();
    } else {
        $('#payment-existing').show();
        $('#payment-new').hide();
        validateCheckoutRefresh();
    }
});
$('#payment-new select[name=\'zone_id\']').bind('change', function() {
    validateCheckoutRefresh();
});
$('#shipping-new select[name=\'zone_id\']').bind('change', function() {
    validateCheckoutRefresh();
});
$('#payment-new select[name=\'country_id\']').bind('change', function() {
    if (this.value == '') return;
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/country&country_id=' + this.value,
        dataType: 'json',
        beforeSend: function() {
            $('#payment-new select[name=\'country_id\']').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('.wait').remove();
        },
        success: function(json) {
            if (json['postcode_required'] == '1') {
                $('#payment-postcode-required').show();
            } else {
                $('#payment-postcode-required').hide();
            }

            html = '<option value="">{{ text_select }}</option>';
            if (json['zone'] != '') {
                for (i = 0; i < json['zone'].length; i++) {
                    html += '<option value="' + json['zone'][i]['zone_id'] + '"';

//                    if (json['zone'][i]['zone_id'] == '{{ zone_id }}') {
//                        html += ' selected="selected"';
//                    }

                    html += '>' + json['zone'][i]['name'] + '</option>';
                }
            } else {
                html += '<option value="0" selected="selected">{{ text_none }}</option>';
            }
            validateCheckoutRefresh();
            $('#payment-new select[name=\'zone_id\']').html(html);
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
});

$('#payment-new select[name=\'zone_id\']').bind('change', function() {
    if (this.value == '') return;
    
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/city&zone_id=' + this.value,
        dataType: 'json',
        beforeSend: function() {
            $('#payment-new select[name=\'zone_id\']').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('.wait').remove();
        },
        success: function(json) {
            html = '<option value="">{{ text_select }}</option>';
            
            if (json != '') {
                for (i = 0; i < json.length; i++) {
                    html += '<option value="' + json[i]['name'] + '"';
                    
                    if (json[i]['name'] == '{{ city }}') {
                        html += ' selected="selected"';
                    }
                    
                    html += '>' + json[i]['name'] + '</option>';
                }
            } else {
                html += '<option value="0" selected="selected">{{ text_none }}</option>';
            }
            
            $('#payment-new select[name=\'city\']').html(html);
            validateCheckoutRefresh();
            
            
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
});

$('#payment-new select[name=\'city\']').bind('change', function() {
    validateCheckoutRefresh();
});

//ON CHECKING - UNCHECKING USE FOR SHIPPING CHECKBOX
    $(document).ready(function(){
    
     var send_password="{{ settings['general']['guestenable'] }}";
   var value = $("input:radio[name=account]:checked").val();
   
   var logged="{{ logged }}";
   var newsletter_setting="{{ settings['general']['newsletter'] }}"
  
     if(value=='register_manual')
     $('#use_password').val('1');
     else
     $('#use_password').val('0');
         



if(logged!=1&&newsletter_setting==1)
{
if(value=='register_manual'||(value=='guest' && send_password==1))
{
 $('#newsletter_checkbox').css({
            "display": "block"
        });
}
else
    $('#newsletter_checkbox').css({
            "display": "none"
        });
}
else
$('#newsletter_checkbox').css({
            "display": "none"
        });
    
var shipping_display="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}";
var loggedIn="{{ logged }}";//271
if(shipping_display=="0" && loggedIn==""){
    $('#checkoutShippingAddress').slideDown('slow');
}
        $("#shipping_use").change(function(){
            if($(this).is(":checked"))
            {
                $('#checkoutShippingAddress').slideUp('slow');
                validateCheckoutRefresh();
            }
            else{
                $('#checkoutShippingAddress').slideDown('slow');
                validateCheckoutRefresh();
            }
        });
    });

// FOR GENERAL SETTINGS LIKE SLIDE UP AND DOWN, AND LOGIN VALIDATION

var generalDefault="{{ settings['general']['default_option'] }}";
var guestEnable="{{ settings['step']['login']['option']['guest']['display'] }}";
var registerEnable="{{ settings['general']['guest_manual'] }}";
var current = $("input:radio[name=account]:checked").val();
if(generalDefault=='guest'&& guestEnable==1 && current=='guest'){
    $('#supercheckout-login').slideUp('slow');
    $('#supercheckout-login-register-manual').show();
    $('#customer_group_div').show();
    $('.supercheckout_password_fields').slideUp('slow');
}
else if(generalDefault=='register'&&registerEnable==1){ 
    $('#supercheckout-login').slideDown('slow');
    $('#customer_group_div').hide();
}
else if(generalDefault=='guest'&&guestEnable==0){ // added if condition here to prevent login dropdown in case of register is selected as default
    $('#supercheckout-login').slideDown('slow');
    $('#supercheckout-login-register-manual').show();
    $('.supercheckout_password_fields').slideUp('slow');
    $('#customer_group_div').show();
}else if (current=='register'||(generalDefault=='register_manual'&&registerEnable==0)){
    $('#supercheckout-login').slideDown('slow');
    $('#customer_group_div').show();
    $('.supercheckout_password_fields').slideDown('slow');
}else if(guestEnable!=1&&registerEnable!=1) { // to slidedown login when both guest checkout and register manual is disable
    $('#customer_group_div').hide();
    $('#supercheckout-login').slideDown('slow');
}
    
    

/////////////////////////////////////////////////////////////////////////
//// Function to handle register when register is selected by default./////
////////////////////////////////////////////////////////////////////////
var value = $("input:radio[name=account]:checked").val();
if (value=="register_manual")
register_manual();
function register_manual()
{
     if(value=='register')
    {
        $('#supercheckout-login-register-manual').slideUp('slow');
        $('#supercheckout-login').slideDown('slow');
        $('#supercheckout-privacy-policy').hide();
    }
    else if(value=='guest'){
        $('#supercheckout-login').slideUp('slow');
        $('#supercheckout-login-register-manual').slideUp('slow');
        $('#supercheckout-privacy-policy').hide();
        $('#customer_group_div').show();
        $('#supercheckout-login-register-manual').show();
        $('.supercheckout_password_fields').slideUp('slow');
    }else if(value=='register_manual'){
        $('#supercheckout-login').slideUp('fast');
        $('#supercheckout-login-register-manual').slideDown('slow');
        $('#supercheckout-privacy-policy').show();
        $('.supercheckout_password_fields').slideDown('slow');
    }
}
//////////////////////////////////////////////////////////////////////
////function to handle register when its rasio button is clicked./////
/////////////////////////////////////////////////////////////////////

$("input:radio[name=account]").click(function() {
    var send_password="{{ settings['general']['guestenable'] }}";
    var value = $("input:radio[name=account]:checked").val();
   
    var logged="{{ logged }}";
    var newsletter_setting="{{ settings['general']['newsletter'] }}"
    
    if(value=='register_manual')
        $('#use_password').val('1');
    else
        $("#use_password").val('0');

    if(logged!=1&&newsletter_setting==1)
    {

        if(value=='register_manual'||(value=='guest'&& send_password==1))
        {
         $('#newsletter_checkbox').css({
                    "display": "block"
                });
        }
        else
            $('#newsletter_checkbox').css({
                    "display": "none"
                });
    }
    if(value=='register')
    {
        $('#supercheckout-login-register-manual').slideUp('slow');
        $('#supercheckout-login').slideDown('slow');
        $('#supercheckout-privacy-policy').hide();
        $('#customer_group_div').hide();
    }
    else if(value=='guest'){
        $('#supercheckout-login').slideUp('slow');
//        $('#supercheckout-login-register-manual').slideUp('slow');
        $('#supercheckout-privacy-policy').hide();
        $('#customer_group_div').show();
        $('#supercheckout-login-register-manual').show();
        $('.supercheckout_password_fields').slideUp('slow');
    }else if(value=='register_manual'){
        $('#supercheckout-login').slideUp('fast');
        $('#supercheckout-login-register-manual').slideDown('slow');
        $('#supercheckout-privacy-policy').show();
        $('#customer_group_div').show();
        $('.supercheckout_password_fields').slideDown('slow');
    }
});
//login
$('#button-login').on('click', function() {
    $.ajax({
        url: 'index.php?route=supercheckout/supercheckout/loginValidate',
        type: 'post',
        data: $('#checkoutLogin :input'),
        dataType: 'json',
        beforeSend: function() {
            $('#button-login').attr('disabled', true);
            $('#button-login').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
        },
        complete: function() {
            $('#button-login').attr('disabled', false);
            $('.wait').remove();
        },
        success: function(json) {
            $('.warning, .error').remove();

            if (json['redirect']) {
                location = json['redirect'];
            } else if (json['error']) {
                $('#checkoutLogin .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + json['error']['warning'] + '</div>');
                $('#checkoutLogin .supercheckout-checkout-content').show();
                $('.warning').fadeIn('slow');
            }
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
});
// FOR ADDING COUPON AND VOUCHERS AND ALSO REDEEMING THEM
//adding 
$('#confirm_password').blur(function () {        
        matchPassword();
});


//adding voucher
function callVoucher(){
    var code=$('#voucher_code').val();
    
    if(code==""){
        if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.voucherBlur=true;
        
        $("#voucher_code").css({
            "background-color": "#FFD1D1"
        });
    }else{
        $("#voucher_code").css({
            "background-color": "white"
        });
        $('#confirm').html('<div id="loading" style="text-align:center;"><img src="image/data/checkoutPage/loading_large.gif" width="100" height="100"></div>');
        $('#confirmLoader').show();
        $.ajax({
            type: "POST",
            url: "index.php?route=supercheckout/supercheckout/validateVoucher",
            data: 'voucher='+code,
            success: function(json) {
                var obj = jQuery.parseJSON( json );

                if (obj.warning) {
                    $("#voucher_code").css({
                        "background-color": "#FFD1D1"
                    });
                    $.gritter.add({
                        title: '{{ text_notification }}',
                        text: obj.warning,
                //	image: '',
                        class_name:'gritter-warning',
                        sticky: false,
                        time: '3000'
                    });
//                    $('#confirmCheckout .supercheckout-checkout-content').html("");
//                    $('#confirmCheckout .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + obj.warning + '</div>');
//                    $('.supercheckout-checkout-content').show();
//                    $('.warning').fadeIn('slow');
                    $('#confirmLoader').hide();
                    if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.voucherBlur=true;
                }
                else{
                    $.gritter.add({
                        title: '{{ text_notification }}',
                        text: '{{ text_voucher_success }}',
                //	image: '',
                        class_name:'gritter-success',
                        sticky: false,
                        time: '3000'
                    });
                    validatePaymentMethodRefresh();
                }

            }

        });
    }
}

function callCoupon(){
    var code=$('#coupon_code').val();
     
    if(code==""){
         if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.couponBlur=true; 
            $("#coupon_code").css({
            "background-color": "#FFD1D1"
        });
    }else{
        $("#coupon_code").css({
            "background-color": "white"
        });
        $('#confirm').html('<div id="loading" style="text-align:center;"><img src="image/data/checkoutPage/loading_large.gif" width="100" height="100"></div>');
        $('#confirmLoader').show();
        $.ajax({
            type: "POST",
            url: "index.php?route=supercheckout/supercheckout/validateCoupon",
            data: 'coupon='+code,

            success: function(json) {
                var obj = jQuery.parseJSON( json );

                if (obj.warning) {
            $("#coupon_code").css({
            "background-color": "#FFD1D1"
             });
                $.gritter.add({
                        title: '{{ text_notification }}',
                        text: obj.warning,
                        class_name:'gritter-warning',
                        sticky: false,
                        time: '3000'
                });
                    $('#confirmLoader').hide();
                    if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.couponBlur=true;
                }
                else{
                        $.gritter.add({
                        title: '{{ text_notification }}',
                        text: '{{ text_coupon_success }}',
                //	image: '',
                        class_name:'gritter-success',
                        sticky: false,
                        time: '3000'
                    });
                           goToConfirmRefresh();
                           
                           
                }

            }
            
        });
    }
}

function callReward(){
      var code=$('#rewards_point').val();
      if(code==""||code==0){
        if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.rewardBlur=true;
        $("#rewards_point").css({
            "background-color": "#FFD1D1"
        });}
        else{
            
        $("#rewards_point").css({
            "background-color": "white"
        });
            $('#confirm').html('<div id="loading" style="text-align:center;"><img src="image/data/checkoutPage/loading_large.gif" width="100" height="100"></div>');
      $('#confirmLoader').show();
  
        $.ajax({
            type: "POST",
            url: "index.php?route=supercheckout/supercheckout/validateReward",
            data: 'reward='+code,

            success: function(json) {
           var obj = jQuery.parseJSON( json );

                if (obj.warning) {
                     $("#rewards_point").css({
            "background-color": "#FFD1D1"
        });
                $.gritter.add({
                        title: '{{ text_notification }}',
                        text: obj.warning,
                //	image: '',
                        class_name:'gritter-warning',
                        sticky: false,
                        time: '3000'
                });
//                    $('#confirmCheckout .supercheckout-checkout-content').html("");
//                    $('#confirmCheckout .supercheckout-checkout-content').prepend('<div class="warning" style="display: none;">' + obj.warning + '</div>');
//                    $('.supercheckout-checkout-content').show();
//                    $('.warning').fadeIn('slow');
                    $('#confirmLoader').hide();
                    if(window.callconfirm==true){
                        validateCheckout();
                        window.callconfirm=false;
                        window.confirmclick=false;
                    }
                    window.callconfirm=false;
                    window.confirmclick=false;
                    window.rewardBlur=true;
                }
                else{
                    
                    $.gritter.add({
                        title: '{{ text_notification }}',
                        text: '{{ text_reward_success }}',
                //	image: '',
                        class_name:'gritter-success',
                        sticky: false,
                        time: '3000'
                    });
                    validatePaymentMethodRefresh();
                }

            }

        });
    }
}


//    redeeming coupon and voucher
function redeem(id){
    $('#confirm').html('<div id="loading" style="text-align:center;"><img src="image/data/checkoutPage/loading_large.gif" width="100" height="100"></div>');
    $('#confirmLoader').show();
    $.ajax({
        type: "POST",
        url: "index.php?route=supercheckout/supercheckout/redeem",
        data: 'redeem='+id,
        success: function() {
            $.ajax({
                url: 'index.php?route=supercheckout/confirm',
                dataType: 'html',
                success: function(html) {
                    $('#confirmCheckout').html(html);
                    if(id == 'coupon') {
                        $.gritter.add({
                                title: '{{ text_notification }}',
                                text:  '{{ coupon_deleted }}',
                                class_name:'gritter-success',
                                sticky: false,
                                time: '3000'
                        });
                    } else if(id=='voucher'){
                        $.gritter.add({
                                title: '{{ text_notification }}',
                                text:  '{{ voucher_deleted }}',
                                class_name:'gritter-success',
                                sticky: false,
                                time: '3000'
                        });
                    }
                    else {
                        $.gritter.add({
                                title: '{{ text_notification }}',
                                text:  '{{ reward_deleted }}',
                                class_name:'gritter-success',
                                sticky: false,
                                time: '3000'
                        });
                    }
                    $('#confirmLoader').hide();
                    $.ajax({
                        url: 'index.php?route=supercheckout/payment_display',
                        dataType: 'html',
                        success: function(html) {
                            $('#display_payment').html(html);
                            $("{{ hidden_classes_trigger }}").hide();
                        },
                        error: function(xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });

                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }

            });
        }

    });
}

//EDITING CART LIKE REMOVING PRODUCT AND UPDATING QUANTITY
    function removeProduct(id){
        var id=id;
        $('#confirmLoader').show();
        $.ajax({
            type: "POST",
            url: "index.php?route=supercheckout/supercheckout/cart",
            data: 'remove='+id,
            success: function(msg){
                if (msg=="Your Cart is empty") 
            {window.location='index.php?route=checkout/cart';}
//            refreshAll();
            validateCheckoutRefresh();
            window.cart_modified=true;
           
            }
        });
    }
    function updateQuantity(id){
        var id=id;
        $('#confirmLoader').show();
        $.ajax({
            type: "POST",
            url: "index.php?route=supercheckout/supercheckout/cart&quantity",
            data: $('#confirmCheckout input[type=\'text\']'),
            success: function(msg){
             if (msg=="Your Cart is empty") 
            {window.location='index.php?route=checkout/cart';}
            validateCheckoutRefresh();
            window.cart_modified=true;            

            }
        });
    }

// FACEBOOK LOGIN & REGISTERING SCRIPT
var facebookEnable="{{ settings['step']['facebook_login']['display'] }}";
    if('{{ logged }}'=='' && facebookEnable==1){
        var button;
        var userInfo;
        window.fbAsyncInit = function() {
            FB.init({
                appId: '{{ appId }}', //change the appId to your appId
                status: true,
                cookie: true,
                xfbml: true,
                oauth: true,
                version: 'v2.8'
            });
            function updateButton(response) {
                button       =   document.getElementById('fb-auth');
                userInfo     =   document.getElementById('user-info');
                if (response.authResponse) {
                    button.onclick = function() {
                        FB.logout(function(response) {
                            logout(response);
                            showLoader(true);
                            FB.login(function(response) {
                                if (response.authResponse) {
                                    FB.api('/me?fields=email,first_name,last_name,gender', function(info) {
                                        login(response, info);
                                    });
                                } else {
                                    //user cancelled login or did not grant authorization
                                    showLoader(false);
                                }
                            }, {
                                scope:'email,user_birthday'
                            });
                        });
                    };
                } else {
                    //user is not connected to your app or logged out
                    button.innerHTML = '';
                    button.onclick = function() {
                        showLoader(true);
                        FB.login(function(response) {
                            if (response.authResponse) {
                                FB.api('/me?fields=email,first_name,last_name,gender', function(info) {
                                    login(response, info);
                                });
                            } else {
                                //user cancelled login or did not grant authorization
                                showLoader(false);
                            }
                        }, {
                            scope:'email,user_birthday'
                        });
                    }
                }
            }

            // run once with current status and whenever the status changes
            FB.getLoginStatus(updateButton);
            FB.Event.subscribe('auth.statusChange', updateButton);
        };
        (function() {
            var e = document.createElement('script');
            e.async = true;
            e.src = document.location.protocol
                + '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
        }(document, 'script', 'facebook-jssdk'));


        function login(response, info){
            if (response.authResponse) {

                showLoader(false);
                    fqlQuery();
            }
        }
        function logout(response){
            showLoader(false);
        }
        function fqlQuery(){
            showLoader(true);
            FB.api('/me?fields=email,first_name,last_name,gender', function(response) {
                showLoader(false);
{#                var query = FB.Data.query('select name,first_name,last_name,email, profile_url, sex, pic_small,contact_email from user where uid={0}', response.id);#}
                    $.ajax({
                        url: 'index.php?route=supercheckout/supercheckout/checkUser/&email='+response.email,
                        success: function(response2) {
                            if(response2=="registered"){
                                showLoader(true);
                                $.ajax({
                                    url: 'index.php?route=supercheckout/supercheckout/doLogin&emailLogin='+response.email,
                                    success: function(response3) {
                                        window.location='index.php?route=supercheckout/'+response3
                                    },
                                    complete: function(){
                                        showLoader(false);
                                    }
                                });
                            }
                            else{
                                showLoader(true);
                                $.ajax({

                                    url: 'index.php?route=supercheckout/supercheckout/getvalue&firstname='+response.first_name+'&last_name='+response.last_name+'&useremail='+response.email,
                                    success: function(response4) {
                                        window.location='index.php?route=supercheckout/'+response4
                                    },
                                    complete: function(){
                                        showLoader(false);
                                    }
                                });
                            }
                        }
                    });
            });
        }
        function showLoader(status){
            if (status){
                $('#loading-image').show();
            }
            else
                $('#loading-image').hide();
        }

    }

// FOR REFRESHING ALL AT ONCE i.e. PAYMENT METHOD, SHIPPING METHOD, CART AND PAYMENT GATEWAY
function refreshAll(){
//window.confirmclick=true;
    $('#shippingMethodLoader').show();
    $.ajax({
        url: 'index.php?route=supercheckout/shipping_method',
        dataType: 'html',
        success: function(html) {
            $.ajax({ //shipping_method/validate ajax start here -->patch to update cost in confirm cart
            url: 'index.php?route=supercheckout/shipping_method/validate',
            type: 'post',
            data: $('#shipping-method input[type=\'radio\']:checked'),
            dataType: 'json',
            beforeSend: function() {
                $('#button-shipping-method').attr('disabled', true);
                $('#button-shipping-method').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-shipping-method').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {   //shipping_method/validate success start here -->patch to update cost in confirm cart
            
            $('#shipping-method').html(html);
            $('#shippingMethodLoader').hide();
            $('#paymentMethodLoader').show();
            
            
            $.ajax({
                url: 'index.php?route=supercheckout/payment_method',
                dataType: 'html',
                success: function(html) {
                    $.ajax({ //payment_method/validate ajax start here -->patch to update cost in confirm cart
                    url: 'index.php?route=supercheckout/payment_method/validate',
                    type: 'post',
                    data: $('#payment-method input[type=\'radio\']:checked, #payment-method input[type=\'checkbox\']:checked, #payment-method textarea,#payment_display_block input[type=\'checkbox\']'),
                    dataType: 'json',
                    success: function(json) { //payment_method/validate success start here -->patch to update cost in confirm cart
                    
                        //$('#payment-method').html(html);
                        $('#paymentMethodLoader').hide();
                        $('#confirmLoader').show();
                        $.ajax({
                            url: 'index.php?route=supercheckout/confirm',
                            dataType: 'html',
                            success: function(html) { 

                                $('#confirmLoader').hide();
                                $('#confirmCheckout').html(html);
                                $('#paymentDisable').html("");
                                $.ajax({
                                    url: 'index.php?route=supercheckout/payment_display',
                                    dataType: 'html',
                                    success: function(html) {

                                        $('#display_payment').html(html);
                                        $("{{ hidden_classes_trigger }}").hide();
                                        if(window.callconfirm==true){
                                            validateCheckout();
                                            window.callconfirm=false;
                                            window.confirmclick=false;
                                        }
                                        window.callconfirm=false;
                                        window.confirmclick=false;
                                        if(window.cart_modified==true){
                                            $.gritter.add({
                                                title: '{{ text_notification }}',
                                                text: '{{ text_remove }}',
                                                class_name:'gritter-success',
                                                sticky: false,
                                                time: '3000'
                                                });
                                                window.cart_modified=false;
                                        }
                            //            validatePaymentMethodRefresh();

                                    },
                                    error: function(xhr, ajaxOptions, thrownError) {
                                    }
                                });	
                            },
                            error: function(xhr, ajaxOptions, thrownError) {
                            }
                        });	
                    }//payment_method/validate success end here -->patch to update cost in confirm cart
           });//payment_method/validate ajax end here -->patch to update cost in confirm cart
                },//payment method success end here
                error: function(xhr, ajaxOptions, thrownError) {
                }
            });
        } //shipping_method/validate success end here -->patch to update cost in confirm cart
        }); //shipping_method/validate ajax end here -->patch to update cost in confirm cart
        },//shipping method success end here
        error: function(xhr, ajaxOptions, thrownError) {
        }
        
    });
    
        
}

//FOR REFRESHING CART AND PAYMENT GATEWAY IF CHANGE IS MADE IN CART ON BILLING ADDRESS
    $('#checkoutBillingAddress #payment-new input[type=\'text\']').blur(function () {
        cartPaymentRefresh();
    });    
    $('#checkoutBillingAddress #payment-new input[name=\'postcode\']').blur(function () {
        validateCheckoutRefresh();
    });
    $('#checkoutShippingAddress #shipping-new input[name=\'postcode\']').blur(function () {
        validateCheckoutRefresh();
    });
    
    function cartPaymentRefresh(){
    var guestEnable="{{ settings['step']['login']['option']['guest']['display'] }}";
    var loggedIn="{{ logged }}";
    var registerEnable="{{ settings['general']['guest_manual'] }}";
    if(guestEnable==1)
    {
        if(loggedIn!=""){
            LoginPaymentAddressRefresh();
        }else{
            GuestPaymentAddressRefresh();
        }
    }
    else
    {
        if(loggedIn!=""){
            LoginPaymentAddressRefresh();
        }else if(registerEnable==1){
            GuestPaymentAddressRefresh();
        }
        else{
            $('#checkoutLogin .supercheckout-checkout-content').html('<div class="warning" style="display: none;">' + '{{ please_login_error }}' + '</div>');
            $('#checkoutLogin .supercheckout-checkout-content').show();
            $('.warning').fadeIn('slow');
            goToByScroll('checkoutLogin');
            enableForm();
        }
    }
}
function LoginPaymentAddressRefresh(){
    var paymentAddressEnable="1";
    if(paymentAddressEnable==1){
        $.ajax({
            url: 'index.php?route=supercheckout/supercheckout/setValueForLoginPayment',
            type: 'post',
            dataType:'json',
            data: $('#checkoutBillingAddress input[type=\'text\'], #checkoutBillingAddress input[type=\'password\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #checkoutBillingAddress input[type=\'radio\']:checked, #checkoutBillingAddress input[type=\'hidden\'], #checkoutBillingAddress select, #checkoutBillingAddress input[type=\'checkbox\']:checked'),
            beforeSend: function() {
                $('#button-payment-address').attr('disabled', true);
                $('#button-payment-address').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
            },
            complete: function() {
                $('#button-payment-address').attr('disabled', false);
                $('.wait').remove();
            },
            success: function(json) {
                $('.warning, .errorsmall').remove();
                if (json['error']){
                    if (json['error']['firstname']) {
                        $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                    }
                    
                    if (json['error']['custom_field']) {
                        for( x in json['error']['custom_field'] ){
                            $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                        }
                    }
                    
                    if (json['error']['lastname']) {
                        $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                    }

                    if (json['error']['email']) {
                        $('#payment-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                    }

                    if (json['error']['telephone']) {
                        $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                    }
                    if (json['error']['company']) {
                        $('#payment-new input[name=\'company\']').after('<span class="errorsmall">' + json['error']['company'] + '</span>');
                    }
                    if (json['error']['address_1']) {
                        $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                    }
                    if (json['error']['address_2']) {
                        $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                    }
                    if (json['error']['city']) {
                        $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                    }

                    if (json['error']['postcode']) {
                        $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                    }

                    if (json['error']['country']) {
                        $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                    }

                    if (json['error']['zone']) {
                        $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                    }
                }else{
                    RefreshCart();
                }
            }
        });
    }
    else{
        RefreshCart();
    }

}
function GuestPaymentAddressRefresh(){
    var paymentGuestAddressEnable="1";
    var useforShippingEnable="{{ settings['option']['guest']['payment_address']['fields']['shipping']['display'] }}";
    if(paymentGuestAddressEnable==1){
        if(useforShippingEnable==1){
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/setValueForGuestPayment',
                type: 'post',
                dataType:'json',
                data: $('#payment-new  input[type=\'text\'], #checkoutBillingAddress input[type=\'checkbox\']:checked, #payment-new select, #checkoutLogin input[name=\'email\'] '),
                beforeSend: function() {
                    $('#button-guest').attr('disabled', true);
                    $('#button-guest').after('<span class="wait">&nbsp;<img src="catalog/view/theme/default/image/supercheckout/loading12.gif" alt="" /></span>');
                },
                complete: function() {
                    $('#button-guest').attr('disabled', false);
                    $('.wait').remove();
                },
                success: function(json) {

                    $('.warning, .errorsmall').remove();
                if (json['error']){
                    if (json['error']['firstname']) {
                        $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                    }
                    
                    if (json['error']['custom_field']) {
                        for( x in json['error']['custom_field'] ){
                            $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                        }
                    }
                    
                    if (json['error']['lastname']) {
                        $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                    }

                    if (json['error']['email']) {
                        $('#payment-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                    }

                    if (json['error']['telephone']) {
                        $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                    }
                    if (json['error']['company']) {
                        $('#payment-new input[name=\'company\']').after('<span class="errorsmall">' + json['error']['company'] + '</span>');
                    }
                    if (json['error']['address_1']) {
                        $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                    }
                    if (json['error']['address_2']) {
                        $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                    }
                    if (json['error']['city']) {
                        $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                    }

                    if (json['error']['postcode']) {
                        $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                    }

                    if (json['error']['country']) {
                        $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                    }

                    if (json['error']['zone']) {
                        $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                    }
                    }else{

                        RefreshCart();
                    }
                }
            });
        }
        else{
            $.ajax({
                url: 'index.php?route=supercheckout/supercheckout/setValueForGuestPayment',
                type: 'post',
                dataType:'json',
                data: $('#payment-new  input[type=\'text\'],  #payment-new select'),
                beforeSend: function() {
                    $('#button-guest').attr('disabled', true);
                    $('#button-guest').after('<span class="wait">&nbsp;<img src="catalog/view/theme/{{ default_theme }}/image/supercheckout/loading12.gif" alt="" /></span>');
                },
                complete: function() {
                    $('#button-guest').attr('disabled', false);
                    $('.wait').remove();
                },
                success: function(json) {
                $('.warning, .errorsmall').remove();
                if (json['error']){
                    if (json['error']['firstname']) {
                        $('#payment-new input[name=\'firstname\']').after('<span class="errorsmall">' + json['error']['firstname'] + '</span>');
                    }
                    
                    if (json['error']['custom_field']) {
                        for( x in json['error']['custom_field'] ){
                            $('#payment-new input[name=\'custom_field['+x+']\']').after('<span class="errorsmall">' + json['error']['custom_field'][x] + '</span>');
                        }
                    }
                    
                    if (json['error']['lastname']) {
                        $('#payment-new input[name=\'lastname\']').after('<span class="errorsmall">' + json['error']['lastname'] + '</span>');
                    }

                    if (json['error']['email']) {
                        $('#payment-new input[name=\'email\']').after('<span class="errorsmall">' + json['error']['email'] + '</span>');
                    }

                    if (json['error']['telephone']) {
                        $('#payment-new input[name=\'telephone\']').after('<span class="errorsmall">' + json['error']['telephone'] + '</span>');
                    }
                    if (json['error']['company']) {
                        $('#payment-new input[name=\'company\']').after('<span class="errorsmall">' + json['error']['company'] + '</span>');
                    }
                    if (json['error']['address_1']) {
                        $('#payment-new input[name=\'address_1\']').after('<span class="errorsmall">' + json['error']['address_1'] + '</span>');
                    }
                    if (json['error']['address_2']) {
                        $('#payment-new input[name=\'address_2\']').after('<span class="errorsmall">' + json['error']['address_2'] + '</span>');
                    }
                    if (json['error']['city']) {
                        $('#payment-new select[name=\'city\']').after('<span class="errorsmall">' + json['error']['city'] + '</span>');
                    }

                    if (json['error']['postcode']) {
                        $('#payment-new input[name=\'postcode\']').after('<span class="errorsmall">' + json['error']['postcode'] + '</span>');
                    }

                    if (json['error']['country']) {
                        $('#payment-new select[name=\'country_id\']').after('<span class="errorsmall">' + json['error']['country'] + '</span>');
                    }

                    if (json['error']['zone']) {
                        $('#payment-new select[name=\'zone_id\']').after('<span class="errorsmall">' + json['error']['zone'] + '</span>');
                    }
                    }else{

                        RefreshCart();
                    }
                }
            });
        }
    }else{

        RefreshCart();
    }
}
function RefreshCart(){
    $.ajax({
        url: 'index.php?route=supercheckout/confirm',
        dataType: 'html',
        success: function(html) {
            $('#confirmCheckout').html(html);
//            $('#paymentDisable').html("");
//            $('#confirmCheckout .supercheckout-checkout-content').prepend('<div class="success">{{ text_remove }}</div>');
//            $('.supercheckout-checkout-content').show();
            $('#confirmLoader').hide();

            $.ajax({
                url: 'index.php?route=supercheckout/payment_display',
                dataType: 'html',
                success: function(html) {
                    $('#display_payment').html(html);
                    $("{{ hidden_classes_trigger }}").hide();
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
        },
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
    });
}

// FOR SUBMITTING ON PRESSING ENTER LIKE LOGIN, COUPON, VOUCHER
$('#email').keypress(function(event){
    if(event.keyCode == 13){
        $('#button-login').click();
    }
});
$('#password').keypress(function(event){    
    if(event.keyCode == 13){
        $('#button-login').click();
    }
});
$('#coupon_code').keypress(function(event){
    if(event.keyCode == 13){
        $('#button-coupon').click();
    }
});
$('#voucher_code').keypress(function(event){
    if(event.keyCode == 13){
        $('#button-voucher').click();
    }
});
$('#rewards_point').keypress(function(event){
    if(event.keyCode == 13){
        $('#button-reward').click();
    }
});
$(document).ready(function(){
    validatePaymentMethodRefresh();
    //payment address sorting
    $('#button-confirm').unbind('click');
{% if (settings['general']['layout'] == '3-Column') %} 
    // FOR SORTING BLOCK AND FIELDS IN SUPERCHECKOUT PAGE

        $('.columnleftsort > .supercheckout-blocks').tsort({
            attr:'data-row'
        });
        $('.columnleftsort > .supercheckout-blocks').each(function(){
            $(this).appendTo('#columnleft-' + $(this).attr('data-column'));

        });

        var $wrapper = $('#payment_address_table');
        $wrapper.find('.sort_data').sort(function (a, b) {
            return +$(a).data("percentage") - + $(b).data("percentage");
        })
        .appendTo( $wrapper );

        //shippping address sorting
        var $wrapper = $('#shipping_address_table');
        $wrapper.find('.sort_data').sort(function (a, b) {
            return +$(a).data("percentage") - + $(b).data("percentage");
        })
        .appendTo( $wrapper );
        //block sorting
    //    $('#button-confirm').unbind('click');
        $('.columnleftsort > .supercheckout-blocks').tsort({
            attr:'data-row'
        });
        $('.columnleftsort > .supercheckout-blocks').each(function(){
            $(this).appendTo('#columnleft-' + $(this).attr('data-column'));

        });

{% elseif (settings['general']['layout'] == '2-Column') %} 
        $('.columnleftsort > .supercheckout-blocks').tsort({attr:'col-inside-data'});
        $('.columnleftsort > .supercheckout-blocks').each(function(){
            if($(this).attr('data-column-inside')=="4") {
                $(this).appendTo('#column-2-lower' );
            } else if($(this).attr('data-column-inside')=="3") {
                $(this).appendTo('#column-1-inside' );
            } else if($(this).attr('data-column-inside')=="2") {
                $(this).appendTo('#column-2-upper');
            } else {
                $(this).appendTo('#columnleft-1');
            }
        })
        $('#columnleft-1 > .supercheckout-blocks').tsort({attr:'data-row'});
        $('#columnleft-1 > .supercheckout-blocks').each(function(){
            $(this).appendTo('#columnleft-' + $(this).attr('data-column') );
        })

        $('#column-2-upper > .supercheckout-blocks').tsort({attr:'data-row'});
        $('#column-2-upper > .supercheckout-blocks').each(function(){
            $(this).appendTo('#column-2-upper' );
        })

        $('#column-2-lower > .supercheckout-blocks').tsort({attr:'data-row'});
        $('#column-2-lower > .supercheckout-blocks').each(function(){
            $(this).appendTo('#column-2-lower' );
        })

        $('#column-1-inside > .supercheckout-blocks').tsort({attr:'data-row'});
        $('#column-1-inside > .supercheckout-blocks').each(function() {
            $(this).appendTo('#column-' + $(this).attr('data-column')+'-inside' );
        })

        var $wrapper = $('#payment_address_table');
        $wrapper.find('.sort_data').sort(function (a, b) {
            return +$(a).data("percentage") - + $(b).data("percentage");
        }).appendTo( $wrapper );

        //Shippping Address Sorting
        var $wrapper = $('#shipping_address_table');
        $wrapper.find('.sort_data').sort(function (a, b) {
            return + $(a).data("percentage") - + $(b).data("percentage");
        }).appendTo( $wrapper );

{% elseif (settings['general']['layout'] == '1-Column') %} 
        $('#columnleft-1 > .supercheckout-blocks').tsort({attr:'data-row'});
        $('#columnleft-1 > .supercheckout-blocks').each(function() {
            $(this).appendTo('#columnleft-1' );
        }); 
{% endif %} 
}); 
$(document).ready(function(){
{% if (layout_name == 'three-column') %} 
        var a = $('#supercheckout-columnleft').height(); 
        var d = $('#supercheckout_login_option_box').height();  
        var e = a-d;
        $('#columnleft-1').css('min-height', e + 'px');
        $('#columnleft-3').css('min-height', e + 'px');
        
        
{% elseif (layout_name == 'two-column') %} 
        var a = $('#supercheckout-columnleft').height();    
        var d = $('#supercheckout_login_option_box').height();  
        var e = a-d;
        $('#columnleft-1').css('min-height', e + 'px');
        var b = $('#column-1-inside').height();
        var c = $('#column-2-inside').height();
        if(c > b) {
            $('#column-1-inside').css('min-height', c + 'px');
        } else {
            $('#column-2-inside').css('min-height', b + 'px');
        }
{% endif %} 
});
</script>
 
<script>
var button_width = $('#confirm_order').width() + 76;

$('#progressbar').css('width', button_width + 'px');

$(window).bind('beforeunload', function() {
       try {
           document.getElementById("shipping_address_id_custom").selectedIndex = -1;
           document.getElementById("payment_address_id_custom").selectedIndex = -1;
       } catch(e) {
            
       }
       $("#payment-address-new").removeAttr("checked");
       $("#payment-address-existing").attr("checked", "checked");
       $("#shipping-address-new").removeAttr("checked");
       $("#shipping-address-existing").attr("checked", "checked");
});

function disableForm(){
   var fieldset_width = $('#supercheckout-fieldset').width();
   var fieldset_height = $('#supercheckout-fieldset').height();
   $('#form_disable').show();
   $('#form_disable').css('width',fieldset_width +'px');
   $('#form_disable').css('height',fieldset_height +'px');
}

function enableForm(){
   $('#form_disable').hide();
}
$('[data-toggle="popover"]').popover();
$('.date').datetimepicker({
        pickTime: false,
});

$('.time').datetimepicker({
        pickDate: false,
        minuteStepping: 15
});	

$('.datetime').datetimepicker({
        pickDate: true,
        pickTime: true
});

</script>

<script>
$('input[name=\'customer_group_id\']').on('change', function() {
    if ($(this).val() == $('input[name="customer_group_id"]').first().val()) {
        $('input[name="shipping_company"], input[name="company"]').closest('tr').css('display', 'none');
    } else {
        $('input[name="shipping_company"], input[name="company"]').closest('tr').css('display', 'initial');
    }
	$.ajax({
            url: 'index.php?route=account/register/customfield&customer_group_id=' + this.value,
            dataType: 'json',
            success: function(json) {
                
                $('.custom-field').hide();
                  $('.address_custom_field').attr('name', 'custom_fields');
                  $('.shipping_address_custom_field').attr('name', 'shipping_custom_fields');
                    $('.custom-field').removeClass('required');
                    $('.account_custom_field').removeAttr('data');
                $('.shipping_address_custom_field').removeAttr('data');
                    
                    for (i = 0; i < json.length; i++) {
                        custom_field = json[i];

                        $('#custom-field' + custom_field['custom_field_id']).show();

                        $('#shipping_custom-field' + custom_field['custom_field_id']).show();
                        $('#input-shipping-custom-field' + custom_field['custom_field_id']).attr('name', 'shipping_custom_field['+custom_field['custom_field_id']+']');
                       $('#input-address-custom-field' + custom_field['custom_field_id']).attr('name', 'custom_field['+custom_field['custom_field_id']+']');
                        

                        if (custom_field['required']) {
                            $('#custom-field' + custom_field['custom_field_id']).addClass('required');
                            $('.display_required' + custom_field['custom_field_id']).show();
                            $('#input-payment-custom-field' + custom_field['custom_field_id']).attr('data','required');
                            $('#input-shipping-custom-field' + custom_field['custom_field_id']).attr('data','required');
                        }
                    }
                },
                error: function(xhr, ajaxOptions, thrownError) {
                        alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
});
</script>

<script>
    
    $(document).ready(function(){
       $('#customer-groups1').trigger("click");  
    });
    $(document).ready(function() {
        $('.js-example-basic-single').select2();
    });
    {% if (logged) %}
        $('input[name=\'customer_group_id\']').trigger("change");
    {% endif %}
</script>

{{ footer }} 
 
