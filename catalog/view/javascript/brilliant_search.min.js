function searchQuery(){var e=$("input[name=search]").val();""!=e?$.ajax({url:searchAction,method:"GET",dataType:"json",data:{search:e,include_cats:includeCategories}}).success(function(s){var a="",l=0,t=s.categories,c=s.products;t&&t.length>0&&maxItems>l&&(a+="<li><h4>"+textCategories+":</h4></li>",$.each(t,function(e,s){a+='<li class="result-search-autocomplete-li">',a+='  <a href="'+s.href.replace("amp;","")+'">',a+='    <div class="search-result-row">',a+='      <div class="search-result-image">',a+='        <img class="result-search-autocomplete-image" src="'+s.thumb+'">',a+="      </div>",a+='      <div class="search-result-category">',vals=s.name.split("&nbsp;&nbsp;&gt;&nbsp;&nbsp;"),lastElem=vals.pop(),a+="        <h5>"+lastElem+'</h5><span style="float: left; color: darkgray; margin-top: -10px;">'+vals.join("&nbsp;&nbsp;&gt;&nbsp;&nbsp;")+"</span>",a+="      </div>",a+="    </div>",a+="  </a>",a+="</li>",l++})),c&&c.length>0&&""!=e&&maxItems>l&&(a+="<li><h4>"+textProducts+":</h4></li>",$.each(c,function(e,s){return l>=maxItems?!1:(a+='<li class="result-search-autocomplete-li">',a+='  <a href="'+s.href.replace("amp;","")+'">',a+='    <div class="search-result-row">',a+='      <div class="search-result-image">',a+='        <img class="result-search-autocomplete-image" src="'+s.thumb+'">',a+="      </div>",a+='      <div class="search-result-price">',a+=0==s.special?"<h5>"+s.price+"</h5>":"<h5>"+s.special+"</h5>",a+="      </div>",a+='      <div class="search-result-info">',a+="        <h5>"+s.name+"</h5>",a+="      </div>",a+="    </div>",a+="  </a>",a+="</li>",void l++)})),$(".show-result").html(a),$(".result-search-autocomplete").css(l>0?{display:"block"}:{display:"none"})}):$(".result-search-autocomplete").css({display:"none"})}$(function(){var e=null;$(".search-autocomplete").keyup(function(){e&&clearTimeout(e),e=setTimeout(searchQuery,ajaxTypeDelay)}),$(document).mouseup(function(){$(".result-search-autocomplete").css({display:"none"})})});